<div xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir ../../input-cache/schemas/R5/fhir-single.xsd">
  <div class="sect1">
  <h2 id="_introduction">Introduction</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The Control chapter of this Standard defines the generic rules that apply to all messages. Subsequent sections define functionally specific messages to be exchanged among certain applications. The specific aspects of message definition that are addressed herein are:</p>
  </div>
  <div class="paragraph">
  <p>a) the form to be used in functional chapters for describing messages. This includes their purpose, their contents, and the interrelationships among them. This form is called an abstract message definition because it is purely a level 7 (application) definition.</p>
  </div>
  <div class="paragraph">
  <p>b) the HL7 encoding rules for converting an abstract message into a string of characters that comprises an actual message.</p>
  </div>
  <div class="paragraph">
  <p>c) the programming procedures required to exchange messages using the HL7 specifications.</p>
  </div>
  <div class="paragraph">
  <p>d) the anticipated relationship with lower level protocols.</p>
  </div>
  <div class="paragraph">
  <p>e) certain message segments that are components of all messages.</p>
  </div>
  <div class="paragraph">
  <p>f) a single message, the acknowledgment message, that MAY be used unchanged in multiple applications.</p>
  </div>
  <div class="sect2">
  <h3 id="_ansi_modal_verbs">ANSI modal verbs</h3>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 1. An effort has been made in this version of Chapter 2 to use the ANSI MODAL verbs as described in ISO/IEC Directive, Appendix G, as delineated in the following table:</caption>
  <colgroup>
  <col style="width: 34%;">
  <col style="width: 33%;">
  <col style="width: 33%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">To convey the Sense of:</th>
  <th class="tableblock halign-left valign-top">Use the following (in UPPERCASE)</th>
  <th class="tableblock halign-left valign-top"></th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Required/Mandatory</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SHALL*</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SHALL NOT*</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Best Practice/Recommendation</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SHOULD*</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SHOULD NOT*</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Acceptable Permitted</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MAY*</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NEED NOT*</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">*Usage of any of these in lower case does not carry the same weight.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_conceptual_approach">Conceptual Approach</h2>
  <div class="sectionbody">
  <div class="sect2">
  <h3 id="_assumptions">Assumptions</h3>
  <div class="paragraph">
  <p>The HL7 Standard makes no assumptions about the ownership of data. It also makes no requirements of its own on the subsequent action of the recipient of data, nor does it make any assumption about the design or architecture of the receiving application system. The scope of HL7 is restricted to the specification of messages between application systems, and the events triggering them. HL7 does not explicitly support, but can be used with, systems that support store and forward and data broadcast facilities (see the HL7 Implementation Support Guide).</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_trigger_events">Trigger events</h3>
  <div class="paragraph">
  <p>The Standard is written from the assumption that an event in the real world of healthcare creates the need for data to flow among systems. The real-world event is called the <strong>trigger event</strong>. For example, the trigger event <strong>a patient is admitted</strong> MAY cause the need for data about that patient to be sent to a number of other systems. The trigger event, <strong>an observation (e.g., a CBC result) for a patient is</strong> <strong>available,</strong> MAY cause the need for that observation to be sent to a number of other systems. When the transfer of information is initiated by the application system that deals with the triggering event, the exchange is termed an <strong>unsolicited update</strong>.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  No assumption is made about the design or architecture of the application/ system creating the unsolicited update. The scope of HL7 is restricted to the specification of messages between application/ systems and the events triggering them.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>HL7 allows the use of trigger events at several different levels of data granularity and inter-relationships. For example, most Patient Administration (ADT) trigger events concern single objects (such as an admit event, which creates a message that contains data about a single person and/or account). Other ADT trigger events are concerned with relationships between more than one object (e.g., the merge events, which specify patient or account merges). Some ADT trigger events pertain to a collection of objects that MAY have no significant inter-relationships (e.g., a record-oriented location-based query, whose response contains data about a collection of inpatients who are related only temporarily, by local geography).</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_acknowledgments_original_mode">Acknowledgments: original mode</h3>
  <div class="paragraph">
  <p>When the unsolicited update is sent from one system to another, this acknowledgment mode specifies that it be acknowledged at the application level. The reasoning is that it is not sufficient to know that the underlying communications system guaranteed delivery of the message. It is also necessary to know that the receiving application processed the data successfully at a logical application level.</p>
  </div>
  <div class="paragraph">
  <p>The acknowledgment MAY contain data of interest to the system that initiated the exchange. For example, if a patient care system has processed the trigger event <strong>a lab test is ordered for a patient</strong>, it MAY send an unsolicited update to a lab application identifying the patient, the test ordered, and various other information about the order. The ancillary system will acknowledge the order when it has processed it successfully. For some pairings of patient care and ancillary department systems the acknowledgment MAY also include the ancillary identification number that was assigned (HL7 does not require Order Entry and Results Reporting applications to interface in this manner, but it supports those that do).</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  <span class="line-through">Original mode acknowledgment was replaced by enhanced mode acknowledgment in version 2.2. Implementers SHALL always value MSH-15 and MSH-16</span> Original mode allows the sender to transmit and receive on a single communication channel.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The HL7 Standard makes no functional interpretation of the requirement that a system commit the data in a message to its database before acknowledging it. All that is required is that the receiving system accept responsibility for the data, providing the same integrity test that it would apply to data from any source. To continue the prior example, the ancillary system MAY acknowledge the order after placing it in an input queue, expecting to fully process the order into its database at a future time. The only assumption is that the input queue is maintained at the same level of integrity as the database.</p>
  </div>
  <div class="paragraph">
  <p>Instances of messages are transient by nature, and can not be expected by transmitter and/or receiver to be persistent after acknowledgment.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_acknowledgments_enhanced_mode">Acknowledgments: enhanced mode</h3>
  <div class="paragraph">
  <p>The HL7 acknowledgment paradigm has been extended to distinguish both accept and application acknowledgments, as well the conditions under which each is required. With a positive accept acknowledgment, the receiving system commits the message to safe storage in a manner that releases the sending system from the need to resend the message. After the message has been processed by the receiving system, an application acknowledgment MAY be used to return the resultant status to the sending system.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_queries">Queries</h3>
  <div class="paragraph">
  <p>Query documentation including messages, segments, special protocols, implementation considerations and examples have been moved to chapter 5. The unsolicited display messages were also moved because their message syntax is query-like in nature.</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_communications_environment">Communications Environment</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The HL7 Standard defines the messages as they are exchanged among application entities and the procedures used to exchange them. As such, it conceptually operates at the seventh level of the ISO model for Open System Intercon­nection (OSI). It is primarily concerned with the data content and interrelationship of messages and with communicating certain application-level error conditions.</p>
  </div>
  <div class="paragraph">
  <p>Since the OSI protocols are not universally implemented, the HL7 Working Group is interested in providing standards that will be useful in the interim. It is also recognized that there is now, and will continue to be, interest in communicating health data among systems operating in communications environ­ments that provide a high level of functionality, but use protocols other than ISO OSI. The universe of environments of interest to HL7 includes, but is not restricted to:</p>
  </div>
  <div class="paragraph">
  <p>a) ad hoc environments that do not provide even basic transport reliability. Such environments consist of point-to-point RS-232 links, modems, and even LANs, if their connection to host computers is made via RS-232 communications links. Until OSI high level standards become truly prevalent, many healthcare interfaces will be implemented over such links. In such an environment, the HL7 Lower Level Protocols (LLP) MAY be used between systems to enhance the capabilities of the communications environment. The HL7 Lower Level Protocols are defined in the HL7 Implementation Guide, which is not an official part of the Standard.</p>
  </div>
  <div class="paragraph">
  <p>b) environments that support a robust transport level, but do not meet the high level requirements. This includes environments such as TCP/IP, DECNET, and SNA.</p>
  </div>
  <div class="paragraph">
  <p>c) ISO and proprietary networks that implement up to presentation and other high level services. IBM&#8217;s SNA LU6.2 and IETF NFS are examples of complete proprietary networks.</p>
  </div>
  <div class="paragraph">
  <p>d) two or more applications running on the same physical and/or logical machine that are not tightly integrated. In these environments, the messaging capabilities MAY be provided by inter-process communications services (e.g., Pipes in a UNIX System).</p>
  </div>
  <div class="paragraph">
  <p>The HL7 Standard assumes that the communications environment will provide the following capabilities:</p>
  </div>
  <div class="paragraph">
  <p>a) error free transmission. Applications can assume that they correctly received all of the transmitted bytes in the order in which they were sent. This implies that error checking is done at a lower level. However, sending applications MAY NOT assume that the message was actually received without receiving an acknowledgment message.</p>
  </div>
  <div class="paragraph">
  <p>b) character conversion. If the two machines exchanging data use different representations of the same character set, the communications environment will convert the data from one representation to the other.</p>
  </div>
  <div class="paragraph">
  <p>c) message length. HL7 sets no limits on the maximum size of HL7 messages. The Standard assumes that the communications environment can transport messages of any length that might be necessary. In practice, sites MAY agree to place some upper bound on the size of messages and MAY use the message continuation protocol, described later in this chapter, for messages that exceed the upper limit.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Just as HL7 makes no assumptions about the design or architecture of the application systems sending and receiving HL7 messages, it makes no assumptions about the communications environment beyond those listed above. In particular, aside from the above assumptions, the communications environment, including its architecture, design and implementation, is outside the scope of HL7.
  </td>
  </tr>
  </table>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_message_framework">Message Framework</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>This section defines the constituents of messages and provides the methodology for defining abstract messages that are used in later chapters. Message construction rules can be found in section 2.4.5.</p>
  </div>
  <div class="sect2">
  <h3 id="_messages">Messages</h3>
  <div class="paragraph">
  <p>A <strong>message</strong> is the atomic unit of data transferred between systems. It is comprised of a group of segments in a defined sequence. Each message has a <strong>message type</strong> that defines its purpose. For example the ADT Message type is used to transmit portions of a patient&#8217;s Patient Administration (ADT) data from one system to another. A three-character code contained within each message identifies its type. These are listed in the Message Type list, Appendix A.</p>
  </div>
  <div class="paragraph">
  <p>The real-world event that initiates an exchange of messages is called a trigger event. See Section <em>2.2.2</em>, "<em>Trigger events</em>," for a more detailed description of trigger events. Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70003"><em>HL7 Tabl__e</em> <em>0003 – Event type</em></a> in Chapter 2C, Code Tables, for a listing of all defined trigger events. These codes represent values such as <strong>A patient is admitted</strong> or <strong>An order event occurred</strong>. There is a one-to-many relationship between message types and trigger event codes. The same trigger event code SHALL NOT be associated with more than one message type; however a message type MAY be associated with more than one trigger event code.</p>
  </div>
  <div class="paragraph">
  <p>All message types and trigger event codes beginning with the letter "Z" are reserved for locally defined messages. Z codes SHALL NOT be defined within the HL7 Standard.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_segments_and_segment_groups">Segments and segment groups</h3>
  <div class="paragraph">
  <p>A <strong>segment</strong> is a logical grouping of data fields. Segments of a message MAY be required or optional. They MAY occur only once in a message or they MAY be allowed to repeat. Each segment is given a name. For example, the ADT message MAY contain the following segments: Message Header (MSH), Event Type (EVN), Patient ID (PID), and Patient Visit (PV1).</p>
  </div>
  <div class="paragraph">
  <p>Each segment is identified by a unique three-character code known as the Segment ID. Although the actual segments are defined in various chapters, the ID codes assigned to the various segments are listed in Appendix A.</p>
  </div>
  <div class="paragraph">
  <p>All segment ID codes beginning with the letter <strong>Z</strong> are reserved for locally defined segments. Z Codes SHALL NOT be defined within the HL7 Standard.</p>
  </div>
  <div class="paragraph">
  <p>Two or more segments MAY be organized as a logical unit called a segment group. A segment group MAY be required or optional and might or might not repeat. As of v 2.5, the first segment in a newly defined segment group will be required to help ensure that unparsable messages will not be inadvertently defined. This required first segment is known as the anchor segment.</p>
  </div>
  <div class="paragraph">
  <p>A segment group is assigned a name that represents a permanent identifier that SHALLNOT be changed.</p>
  </div>
  <div class="paragraph">
  <p>A named segment X MAY occur more than once in an abstract message syntax. This differs from repetition described earlier in this section. When this occurs, the following rules SHALL be adhered to:</p>
  </div>
  <div class="paragraph">
  <p>If, within an abstract message syntax, a named segment X appears in two individual or group locations, and</p>
  </div>
  <div class="paragraph">
  <p>a) Either appearance is optional or repeating in an individual location or,</p>
  </div>
  <div class="paragraph">
  <p>b) either appearance is optional or repeating in a group location</p>
  </div>
  <div class="paragraph">
  <p>then, the occurrences of segment X SHALL be separated by at least one required segment of a different name so that no ambiguity can exist as to the individual or group location of any occurrence of segment X in a message instance.</p>
  </div>
  <table class="tableblock frame-all grid-all" style="width: 99%;">
  <caption class="title">Table 2. Examples of proper segment grouping</caption>
  <colgroup>
  <col style="width: 33%;">
  <col style="width: 35%;">
  <col style="width: 32%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 3</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ SEG 1}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG1 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG1</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG2 ]</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG1 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG3</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG1 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ SEG1 }</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 3. Examples of unparsable segment grouping</caption>
  <colgroup>
  <col style="width: 26%;">
  <col style="width: 26%;">
  <col style="width: 24%;">
  <col style="width: 24%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 3</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Example 4</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ SEG 1}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ SEG1 }</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG1 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ SEG1 }</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG1 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG2 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ SEG2 ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG3 ]</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG1</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SEG3</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>In each of these examples it is not possible to tell which part of the message SEG1 belongs.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_fields">Fields</h3>
  <div class="paragraph">
  <p>A field is a string of characters. Fields for use within HL7 segments are defined by HL7. A comprehensive data dictionary of all HL7 fields is provided in Appendix A.</p>
  </div>
  <div class="paragraph">
  <p>Refer to section <a href="#protocol-for-interpreting-repeating-fields-in-an-update-message"><em>2.10.5</em></a>, "<a href="#protocol-for-interpreting-repeating-fields-in-an-update-message"><em>Protocol for interpreting repeating segments or segment groups in an update Message</em></a>" for information on updating records in a database.</p>
  </div>
  <div class="paragraph">
  <p>Version control rules regarding fields can be found in section <em>2.7</em>, "<em>Version compatibility definition</em>".</p>
  </div>
  <div class="paragraph">
  <p>Local extension rules regarding fields can be found in section <em>2.10</em>, "<em>Local Extension</em>".</p>
  </div>
  <div class="sect3">
  <h4 id="_field_or_component_status">Field or Component Status</h4>
  <div class="paragraph">
  <p>HL7 does not care how systems actually store data within an application. When fields are transmitted, they are sent as character strings</p>
  </div>
  <div class="paragraph">
  <p>A field SHALL exist in one of three population states in an HL7 message:</p>
  </div>
  <div class="paragraph">
  <p><strong>Populated</strong>. (Synonyms: valued, non-blank, not blank, not empty.) The sending system sends a value in the field. For example, if a sending system includes medical record number, that would be communicated as |1234567<sup>^</sup>MR^KP-CA|.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  that the field might be populated with a code that means "no information" or "unknown".
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p><strong>Not populated</strong>. (Synonyms: unpopulated, not valued, unvalued, blank, empty, not present, missing.) The sending system does not supply a value for the field. The Sender might or might not have a value for the field. The receiving system can make no inference regarding the absence of an element value if there is not a conformance profile governing the implementation. However, if there is a Conformance Message Profile in effect, then special rules apply; see section 2.B, "Conformance Using Message Profiles".</p>
  </div>
  <div class="paragraph">
  <p><strong>Null. HL7 v2.x does not have an explicit concept for null values.</strong></p>
  </div>
  <div class="paragraph">
  <p><strong>Populated with Delete Indicator:</strong> Any existing value for the corresponding data base element in the receiving application SHOULD be deleted. This is symbolically communicated as two double-quotes between the delimiters (i.e., |""|).Employing consecutive double quote characters as the only content of a field for other purposes is prohibited.</p>
  </div>
  <div class="paragraph">
  <p>Refer to Chapter <a href="#<em>Message_construction_rules">_2.5</em></a>, "<a href="#<em>Message_construction_rules">_Message construction rules</em></a>" for information on data fields with a delete indicator.</p>
  </div>
  <div class="paragraph">
  <p>The various chapters of the Standard contain segment attribute tables. These tables list and describe the data fields in the segment and characteristics of their usage. In defining a segment, the following information is specified about each field:</p>
  </div>
  <div class="paragraph">
  <p>1. SEQ : Position</p>
  </div>
  <div class="paragraph">
  <p>2. LEN : Normative Length</p>
  </div>
  <div class="paragraph">
  <p>3. C.LEN : Conformance Length</p>
  </div>
  <div class="paragraph">
  <p>4. DT : Data Type</p>
  </div>
  <div class="paragraph">
  <p>5. OPT: Optionality</p>
  </div>
  <div class="paragraph">
  <p>6. RP/# : Repitition</p>
  </div>
  <div class="paragraph">
  <p>7. TBL# : Table Identifier</p>
  </div>
  <div class="paragraph">
  <p>8. ITEM# : ID Number</p>
  </div>
  <div class="paragraph">
  <p>9. Element Name</p>
  </div>
  <div class="paragraph">
  <p>Chapter 2A contains similar tables that describe the components of a data type. In defining a data type, the following information is specified about each component:</p>
  </div>
  <div class="paragraph">
  <p>1. SEQ : Position</p>
  </div>
  <div class="paragraph">
  <p>2. LEN : Normative Length</p>
  </div>
  <div class="paragraph">
  <p>3. C.LEN : Conformance Length</p>
  </div>
  <div class="paragraph">
  <p>4. DT : Data Type</p>
  </div>
  <div class="paragraph">
  <p>5. OPT: Optionality</p>
  </div>
  <div class="paragraph">
  <p>6. TBL# : Table Identifier</p>
  </div>
  <div class="paragraph">
  <p>7. Component Name</p>
  </div>
  <div class="paragraph">
  <p>8. Comments</p>
  </div>
  <div class="paragraph">
  <p>9. SEC.REF: The reference to where the data type is defined</p>
  </div>
  <div class="paragraph">
  <p>The following sections describe the information that is provided in the table.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_position_sequence_within_the_segment">Position (sequence within the segment)</h4>
  <div class="paragraph">
  <p>Ordinal position of the data field within the segment. This number is used to refer to the data field in the text comments that follow the segment definition table.</p>
  </div>
  <div class="paragraph">
  <p>In the segment attribute tables this information is provided in the column labeled <strong>SEQ</strong>.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_length">Length</h4>
  <div class="paragraph">
  <p>If applicable, the number of characters that one occurrence of the data field or component MAY occupy if populated.</p>
  </div>
  <div class="paragraph">
  <p>For full discussion, consult section 2.5.5</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_conformance_length">Conformance Length</h4>
  <div class="paragraph">
  <p>If applicable, the conformance length that applies to the field or component. For full discussion, consult section 2.5.5</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_data_type">Data type</h4>
  <div class="paragraph">
  <p>The basic building block used to construct or restrict the contents of a data field.</p>
  </div>
  <div class="paragraph">
  <p>In the segment attribute tables this information is provided in the column labeled <strong>DT</strong>. If the data type of the field is variable, the notation "varies" will be displayed.</p>
  </div>
  <div class="paragraph">
  <p>There are a number of data types defined by HL7. See section <em>2.14</em>, "<a href="file:///D:\Eigene%20Dateien\V27_CH02A_DataTypes.doc"><em>Data types</em></a>" and in Chapter 2A.</p>
  </div>
  <div class="paragraph">
  <p>Each field is assigned a data type that defines the value domain of the field – the possible values that it SHALL take. The data type SHALL have a type taken from the list of data types defined in chapter 2A.</p>
  </div>
  <div class="paragraph">
  <p>Data types MAY be either primitive or composite. Primitive data types consist of a series of characters as specified by the data type. Composite data types are made up of a series of components that are themselves assigned to a data type, which MAY again be either primitive or composite data types. In the case of composite data types, the components of a component are called sub-components, and they SHALL only be assigned primitive data types.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  that the data types do not specify how systems actually store data within an application. When fields are transmitted, they are sent as character strings as specified by the data type.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_optionality">Optionality</h4>
  <div class="paragraph">
  <p>Whether the field is required, optional, or conditional in a segment.</p>
  </div>
  <div class="paragraph">
  <p>In the segment attribute tables this information is provided in the column labeled <strong>OPT</strong>.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 4. The designations for optionality are:</caption>
  <colgroup>
  <col style="width: 8%;">
  <col style="width: 4%;">
  <col style="width: 88%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">RE</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Required but MAY be Empty: The field or data type component description SHALL stipulate when the field or data type component MAY be empty.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">O</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">C(a/b)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>conditional on the trigger event or on some other field(s). The field definitions following the segment attribute table SHOULD specify the algorithm that defines the conditionality for this field. An element with a conditional usage code has an associated condition predicate (See section 2.B.79.9 “Condition Predicate” that determines the requirements (usage code) of the element.</p>
  </div>
  <div class="paragraph">
  <p>If the condition predicate associated with the element is true, follow the rules for <strong><em>a</em></strong> which SHALL be one of “R”, “RE”, “O” or X”:</p>
  </div>
  <div class="paragraph">
  <p>If the condition predicate associated with the element is false, follow the rules for <strong><em>b</em></strong> which SHALL be one of “R”, “RE”, “O” or X”.</p>
  </div>
  <div class="paragraph">
  <p><strong><em>a</em></strong> and <strong><em>b</em></strong> can be valued the same.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">not used with this trigger event</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">B</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">left in for backward compatibility with previous versions of HL7. The field definitions following the segment attribute table SHOULD denote the optionality of the field for prior versions.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">W</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Withdrawn</p></td>
  </tr>
  </tbody>
  </table>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  For Versions 2.3 and higher: the optionality of fields SHOULD be explicitly documented in the segment field definitions that follow each segment definition table; if the optionality of fields within a segment changes depending on the trigger event, that optionality SHOULD also be explicitly documented.
  </td>
  </tr>
  </table>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Conditionality defined in Chapter 2 is further expanded by the requirements stated in Chapter 2B. See Chapter 2.B for the explanation of the c(a/b) approach.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>For version 2.5 and higher, the optionality, table references, and lengths of data type components are supplied in component tables of the data type definition. The component definitions that follow the component table will elaborate on the optionality and table references. Where needed, additional detailed field definitions will follow the formal segment attribute tables. (See also Sections 2.14, ”Message delimiters”, 2.14,”Data types “ ).</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_repetition">Repetition</h4>
  <div class="paragraph">
  <p>Whether the field MAY repeat. The value that appears in the repetitions column is the maximum number of allowed occurrences, e.g., a value of '3' would mean that the field can have '3 occurrences'; if unspecified, there is only one occurrence, i.e., cannot repeat.</p>
  </div>
  <div class="paragraph">
  <p>In the segment attribute tables this information is provided in the column labeled <strong>RP/#.</strong> Note that components and subcomponents MAY NOT repeat, so this does not apply to components and subcomponents.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 5. The designations for Repetition are:</caption>
  <colgroup>
  <col style="width: 14%;">
  <col style="width: 4%;">
  <col style="width: 82%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">N or blank</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">no repetition</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">the field MAY repeat an indefinite or site-determined number of times</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(integer)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">the field MAY repeat up to the number of times specified by the integer</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>Each occurrence MAY contain the number of characters specified by the field&#8217;s maximum length. See Section <em>2</em>.</p>
  </div>
  <div class="paragraph">
  <p>Usage Note: For improved readability some work groups opt to leave the Repetition fields blank to indicate that the field SHALL NOT repeat. A blank SHALL NOT be construed to mean that the field MAY optionally repeat.</p>
  </div>
  <div class="paragraph">
  <p>As of v2.5 the Repetition column is to be left blank if the field SHALL NOT repeat.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_table">Table</h4>
  <div class="paragraph">
  <p>Refer to Chapter 2.C, "Code Tables".</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_id_number">ID number</h4>
  <div class="paragraph">
  <p>a small integer that uniquely identifies the data item throughout the Standard<strong>.</strong> In the segment definition this information is provided in the column labeled <strong>ITEM #.</strong></p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_name">Name</h4>
  <div class="paragraph">
  <p>Descriptive name for the data item. In the segment attribute tables this information is provided in the column labeled <strong>ELEMENT NAME</strong>.</p>
  </div>
  <div class="paragraph">
  <p>When the same name is used in more than one segment, it SHALL have the same data type and semantic meaning in each segment as well as the same ID number. To deal with any ambiguities arising from this convention, whenever a field is referenced herein, the segment name and position SHALL always be included.</p>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_delimiters">Message delimiters</h3>
  <div class="paragraph">
  <p>In constructing a message, certain special characters are used. They are the segment terminator, the field separator, the component separator, subcomponent separator, repetition separator, escape character and truncation character. The segment terminator is always a carriage return (in ASCII 13,hex 0D). The other delimiters are defined in the MSH segment, with the field delimiter in the 4th character position, and the other delimiters occurring as in the field called Encoding Characters, which is the first field after the segment ID. The delimiter values used in the MSH segment are the delimiter values used throughout the entire message. In the absence of other considerations, HL7 recommends the suggested values found in Figure 2-1 delimiter values.</p>
  </div>
  <div class="paragraph">
  <p>At any given site, the subset of the possible delimiters MAY be limited by negotiations between applications. This implies that the receiving applications will use the agreed upon delimiters, as they appear in the Message Header segment (MSH), to parse the message.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The binary representation of the delimiter characters will vary with the character set used in the message.
  </td>
  </tr>
  </table>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 6. Figure 2-1. Delimiter values</caption>
  <colgroup>
  <col style="width: 19%;">
  <col style="width: 9%;">
  <col style="width: 15%;">
  <col style="width: 57%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Delimiter</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Suggested Value</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Encoding Character Position</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Usage</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Segment Terminator</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;cr&gt;</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Terminates a segment record. This value cannot be changed by implementers.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field Separator</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Separates two adjacent data fields within a segment. It also separates the segment ID from the first data field in each segment.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Component Separator</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">^</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Separates adjacent components of data fields where allowed.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Repetition Separator</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">~</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Separates multiple occurrences of a field where allowed.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Escape Character</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Escape character for use with any field, component, or sub-component.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Subcomponent Separator</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&amp;</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Separates adjacent subcomp­onents of data fields where allowed.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Truncation character</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">#</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Indicated character to be used for the truncation pattern - See 2.4.5.2, Truncation Pattern.</p></td>
  </tr>
  </tbody>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_length_2">Length</h3>
  <div class="paragraph">
  <p>While the length is not generally of conceptual importance in HL7 messages, most HL7 aware applications are implemented using some form of data storage that imposes length limitations on the data. This section describes how the lengths of the fields are controlled, and how interoperability can be arranged in this context.</p>
  </div>
  <div class="sect3">
  <h4 id="_normative_length">Normative Length</h4>
  <div class="paragraph">
  <p>For some fields or components, the value domain of the content leads to clearly established boundaries for minimum and/or maximum length of the content. In these cases, these known limits are specified for the item. Normative lengths are only specified for primitive data types.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  s of value domains that have clearly established boundaries for minimum and maximum length:
  </div>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>A date/time field: See 2.A.22 DTM date/time for detailed examples.</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>o 4..4 for year</p>
  </div>
  <div class="paragraph">
  <p>o 4..6 for Year to month</p>
  </div>
  <div class="paragraph">
  <p>o 8..8 for year to day</p>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>A component whose values are limited to a set of fixed length strings, e.g.(ABC, SYL, or IDE)A component that contains a reference to a field in a message</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>The information is given in one of two forms:</p>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>The minimum and the maximum length separated by two dots, e.g. m..n</p>
  </li>
  <li>
  <p>the list of possible values for length separated by commas, e.g. x,y,z</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>When a normative length is asserted and assertion is a range, conformant messages SHALL have a length that lies within the boundaries specified. The boundaries are inclusive, so a length of 1..2 means the length of the item SHALL be either 1 or 2. When a normative length is asserted and assertion is a list of values, conformant messages SHALL have a length that is one of the values in the list.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The minimum length is always 1 or more. If an item is optional, and there is no content present, the item is considered as not populated, rather than present with a length of 0.
  </td>
  </tr>
  </table>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The deletion indicator is treated as having no length and therefore fits to all length specifications.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_length_persistent_data_stores">Length &amp; Persistent Data Stores</h4>
  <div class="paragraph">
  <p>For many fields or components, the value domain of the content does not lead to clearly established boundaries for minimum and/or maximum length of the content.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  s of value domains that do not have clearly established boundaries for minimum and maximum length:
  </div>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>Parts of Names and Addresses</p>
  </li>
  <li>
  <p>Codes defined in external code systems</p>
  </li>
  <li>
  <p>Descriptive text</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>In many cases, systems store the information of these value domains using data storage mechanisms that have fixed lengths, such as relational databases, and must impose a limitation on the amount of information that can be stored. Though this does not directly impact on the length of the item in the instance, nevertheless the storage length has great significance for establishing interoperability.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_truncation_pattern">Truncation Pattern</h4>
  <div class="paragraph">
  <p>For technical and/or architectural reasons, many applications must define a limit to the length that they will store for a particular item. This creates a need for the length of an element to be defined somewhere and raises the question of what is intended to happen if a real world value is longer than the acceptable value. The problem of how to handle this is unaffected by whether it is the standard that defines the length, or the receiving system that defines the length: what can be done?</p>
  </div>
  <div class="paragraph">
  <p>The most obvious response is that the data must be rejected, and either the message cannot be constructed or must be rejected completely. For some data items, this is the only clinically safe behaviour.On the other hand, for some data items such as names and addresses, this is generally unwelcome information – the system can still function to some degree in the presence of truncated data.</p>
  </div>
  <div class="paragraph">
  <p>However truncation of data can have later consequences – if a data item such as a particularly long surname is truncated, and then returned to the source application in the truncated form, the source application might not correctly match on the truncated name.</p>
  </div>
  <div class="paragraph">
  <p>For this reason, when values are truncated because they are too long (whether because some applicable specification limits the length of the item, or because the application is not able to store the full value), the value SHOULD be truncated at N-1, where N is the length limit, and the final character replaced with a special truncation character. This means that whenever that value is subsequently processed later, either by the system, a different system, or a human user, the fact that the value has been truncated has been preserved, and the information can be handled accordingly.</p>
  </div>
  <div class="paragraph">
  <p>The truncation character is not fixed; applications MAY use any character. The truncation character used in the message is defined in MSH-2. The default truncation character in a message is # (ASCII 35, HEX 23),because the character must come from the narrow range of allowed characters in an instance. The truncation character only represents truncation when it appears as the last character of a truncatable field. It SHALL be escaped if the last character of the data that is the maximum allowable size for the component is the truncation character.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  For a field with a conformance length of 5 where the content is |1234\P\| the truncation character is not representing truncation, it is the actual data.
  </div>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The selection of # as truncation character is taken from ISO 22220 and 27527.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_conformance_length_2">Conformance Length</h4>
  <div class="paragraph">
  <p>If populated, the conformance length column specifies the minimum length that applications must be able to store. Conformant applications SHALL NOT truncate a value that is shorter than the length specified. The conformance length is also the minimum value that SHOULD be assigned to maximum length in an implementation profile.</p>
  </div>
  <div class="paragraph">
  <p>In addition, the conformance length MAY be followed by a “=” or a “<mark>”. The “=” denotes the value MAY never be truncated, and the “</mark>” denotes that the truncation behaviour defined for the data type applies.</p>
  </div>
  <div class="paragraph">
  <p>Applications are not required to implement the truncation pattern, even if it can be applied to an item. Applications SHOULD declare their adoption of the truncation pattern in their conformance profiles.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_type_and_componentfield_lengths">Type and Component/Field lengths</h4>
  <div class="paragraph">
  <p>Either normative or conformative lengths MAY be specified on a primitive data type. Whether or not normative or conformance lengths are specified on the data type, they MAY also be specified on the components and/or fields where the data type is used. If specified here, they override the length specified for the type (but must be consistent with the information on the type). If not specified, then the information specified on the data type itself – if present – applies where the data type is used.</p>
  </div>
  <div class="paragraph">
  <p>Minimum and maximum lengths are not assigned for composite data types (data types having more than one component). Not only can the minimum or maximum lengths be indeterminate, it is misleading to report a length with separator characters included, and also misleading to associate a length with a composite component that must be broken up when it is stored. For these reasons derived lengths are not reported in this standard, though implementers MAY derive them as desired.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_implications_for_implementers">Implications for Implementers</h4>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 7. In an ideal world, the standard would be able to determine the maximum length for a value with authority, and all implementations would be able to handle the maximum length. However neither of these are true, and so this specification defines both normative maximum length, conformance length, and whether a value MAY be truncated. This following table summarises how these various parameters interact, provides an example of each combination, and outlines the implications for implementations. The second data type listed refers to the underlying data type the cited one is based upon.</caption>
  <colgroup>
  <col style="width: 11%;">
  <col style="width: 7%;">
  <col style="width: 6%;">
  <col style="width: 7%;">
  <col style="width: 69%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">ID/DT</th>
  <th class="tableblock halign-left valign-top">Child DT</th>
  <th class="tableblock halign-left valign-top">LEN</th>
  <th class="tableblock halign-left valign-top">C.LEN</th>
  <th class="tableblock halign-left valign-top">Implication</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">CX.5</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2..5</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>CX.5 MAY contain a number of fixed values, all of which have a length between 2 and 5. Other values are not allowed.</p>
  </div>
  <div class="paragraph">
  <p>Truncation is not allowed.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">15=</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">The conformance length is 15 – applications SHALL be able to properly handle all values, which includes the range of allowed lengths for this component.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ED.3</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>ED.3 is one of the few examples where an ID value is taken from an externally derived code system (IANA mime types in this case).</p>
  </div>
  <div class="paragraph">
  <p>The conformance length is 32: applications SHALL be able to handle mime types up to a length of 32. Applications can choose to handle more if desired.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">15=</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Since truncation is not allowed, applications SHALL respond with an error if the length of a mime type exceeds the length it can handle without truncation.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">CWE.1</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">20=</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>If populated, the value SHALL be at least one character. There is no upper limit to the number of characters that are allowed, since this specification cannot apply a limit to the external code systems that CWE is provided to support. In particular, Snomed-CT (post-coordinated) expressions MAY be provided in the coding identifier component.</p>
  </div>
  <div class="paragraph">
  <p>However this specification does not impose the requirement to support arbitrarily long values in this very common component. Instead, applications SHALL support codesystem identifiers up to 20 characters long.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ST</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>Since the identifier is useless if truncated, truncation SHALL NOT be allowed.</p>
  </div>
  <div class="paragraph">
  <p>Application designers SHOULD consider the range of possible values and how they are handled. If the application imposes a maximum limit, this SHOULD be published in the application conformance profile.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">FN.1</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">50#</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>FN.1 contains a surname. This specification is not in a position to impose an upper normative limit on the length of all surnames in the world.</p>
  </div>
  <div class="paragraph">
  <p>However our collective experience shows that values longer than 50 are rarely encountered, so applications SHALL be able to handle values up to the length of 50 without truncation.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ST</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Applications MAY choose to truncate values longer than 50 characters. If applications do this, the truncation pattern SHOULD be followed in order to reduce the risks of downstream handling of the data following truncation.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XAD.5</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">12=</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>XAD.5 is postal/zip code. This specification is not able to impose a normative limit on the size of postal codes around the world, but our collective experience is that 12 covers all the currently known postal systems.</p>
  </div>
  <div class="paragraph">
  <p>Because postal code is used as an identifier in postal delivery systems, it is not appropriate to truncate the value.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ST</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XPN.12</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XPN.12 specifies the date that a person name became applicable. By default, this field allows a highly precise date including milliseconds and a time zone. Applications are not required to implement this level of precision; they MAY truncate the value to a the day containing the specified time interval.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">DTM</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">4..24</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">8#</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">CWE.16</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">4..24</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">8=</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">CWE.16 specifies the date that a value set was published. In some contexts, the publication date of a value set MAY be identified by a date precise to at least hours and minutes in order to allow multiple releases in a single day.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">DTM</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">4..24</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">8#</p></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>However this is an unusual use case; nearly all value sets only identify their publication date to the nearest day.</p>
  </div>
  <div class="paragraph">
  <p>For this reason applications are only required to handle value sets specified to the particular day. However, since the publication date identifies a particular version of the value set, applications are not allowed to truncate the publication date. This specification recommends but does not require that applications support a full date time for this value.</p>
  </div>
  <div class="paragraph">
  <p>Note that the base DTM type default conformance length is that all applications are required to be able to store a full day, and are allowed to truncate dates to this length. These rules MAY be overridden where DTM is used.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NTE.1</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NTE.1 is the segment Id. The segment id MAY have any value between 1 and 9999. Applications are required to handle all these values.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SI</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..4</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">4=</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SN.2</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SN.2 is a numerical value from a structured numeric presented in decimal form. It has a normative length of 16.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NM</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">1..16</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">The NM data type defines its own truncation pattern driven by the semantics of numbers. The truncation character SHALL NOT be used. While there is no conformance length specified, the truncation rules for the NM data type SHALL always be followed; the application SHALL reject the instance if it is unable to conform to these rules.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ED.5</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>ED.5 is text data of arbitrary length. This specification does not apply either a normative length or a conformance length. This does not mean that applications are not required to handle data of infinite length. Applications MAY choose to define limits on the length of data handled in their conformance profiles.</p>
  </div>
  <div class="paragraph">
  <p>Note that the length of data handled can depend on the type of the data.</p>
  </div></div></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">TX</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_acknowledgment_choreography">Acknowledgment Choreography</h3>
  <div class="paragraph">
  <p>Acknowledgment Choreography is defined as the definition of the acknowledgments to be expected for a given trigger event. It is required to document the expected acknowledgment based on the values in link:#_MSH-15<em>_Accept Acknowledgment Type[MSH-15] and link:#_MSH-16</em>_Application Acknowledgment[MSH-16].</p>
  </div>
  <div class="paragraph">
  <p>As of V2.9, all chapters SHALL include in their trigger event definitions the acknowledgment choreography.</p>
  </div>
  <div class="paragraph">
  <p>The first row SHALL contain the words "Acknowledgment Choreography". The second row SHALL contain the message definition being described. When multiple message definitions have the same response in the same chapter all of the message pairs MAY be listed in the second row.</p>
  </div>
  <div class="paragraph">
  <p>The values rows MSH-15 and MSH-16 are extracted from the valid values for the field.</p>
  </div>
  <div class="paragraph">
  <p>The Application ACK row SHOULD contain the message expected in reponse to the processing of the message named in third row containing the value(s) for MSH-16 in that column.</p>
  </div>
  <div class="paragraph">
  <p>For proper formatting please consult the styleguide.</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_message_construction_rules">Message construction rules</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>This section addresses HL7 general rules for composing messages. Both the sender and receiver of the data must have predictable rules for how they will process the data. The reader is also referred to Section 2.B, "Conformance Using Message Profiles", where procedures for ensuring messaging integrity are discussed in detail.</p>
  </div>
  <div class="paragraph">
  <p>In constructing a message, certain special characters are used. They are the segment terminator, the field separator, the component separator, subcomponent separator, repetition separator, escape character and the truncation character. The segment terminator is always a carriage return (in ASCII 13, hex 0D).The other delimiters are defined in the MSH segment, with the field delimiter in the 4th character position, and the other delimiters occurring as in the field called Encoding Characters, which is the first field after the segment ID. The delimiter values used in the MSH segment are the delimiter values used throughout the entire message. In the absence of other considerations, HL7 recommends the suggested values found in Figure 2-1 delimiter values.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  These message construction rules define the standard HL7 encoding rules, creating variable length delimited messages. Although only one set of encoding rules has been defined as a standard since HL7 Version 2.3, other encoding rules are possible (but since they are non-standard, they MAY only be used by a site-specific agreement).
  </td>
  </tr>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_message_construction_pseudocode">Message Construction Pseudocode</h3>
  <div class="paragraph">
  <p>procedure construct_message ( data ) \{</p>
  </div>
  <div class="paragraph">
  <p>identify_message_needed;</p>
  </div>
  <div class="paragraph">
  <p>identify_separators_used;</p>
  </div>
  <div class="paragraph">
  <p>validate( data );</p>
  </div>
  <div class="paragraph">
  <p>order_segments( data, segment_list );</p>
  </div>
  <div class="paragraph">
  <p>foreach segment in ( segment_list ) \{</p>
  </div>
  <div class="paragraph">
  <p>insert segment.name; /* e.g., MSH */</p>
  </div>
  <div class="paragraph">
  <p>/* gather all data for fields */</p>
  </div>
  <div class="paragraph">
  <p>foreach field in ( fields_of( segment ) ) \{</p>
  </div>
  <div class="paragraph">
  <p>insert field separator; /* e.g., | */</p>
  </div>
  <div class="paragraph">
  <p>/* gather occurrences (MAY be multiple only for fields that are allowed to repeat */</p>
  </div>
  <div class="paragraph">
  <p>foreach occurrence in ( occurrences_of( field ) ) \{</p>
  </div>
  <div class="paragraph">
  <p>construct_occurrence( occurrence );</p>
  </div>
  <div class="paragraph">
  <p>if not last ( populated occurrence ) insert repetition_separator; /* e.g., ~ */</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>break if last ( populated field );</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>insert segment_terminator; /* always&lt;cr&gt;! */</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>return;</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>procedure construct_occurrence ( occurrence ) \{</p>
  </div>
  <div class="paragraph">
  <p>/* gather populated components */</p>
  </div>
  <div class="paragraph">
  <p>foreach component in ( components_of( occurrence ) ) \{</p>
  </div>
  <div class="paragraph">
  <p>get_subcomponent_data( component );</p>
  </div>
  <div class="paragraph">
  <p>/* gather all data for subcomponents */</p>
  </div>
  <div class="paragraph">
  <p>foreach subcomponent in ( subcomponents_of( component ) ) \{</p>
  </div>
  <div class="paragraph">
  <p>substitute( escape_character, \E\ );</p>
  </div>
  <div class="paragraph">
  <p>/* escape the field separator */</p>
  </div>
  <div class="paragraph">
  <p>substitute( field_separator, \F\ );</p>
  </div>
  <div class="paragraph">
  <p>/* escape the encoding characters */</p>
  </div>
  <div class="paragraph">
  <p>substitute( component_separator, \S\ );</p>
  </div>
  <div class="paragraph">
  <p>substitute( repetition_separator, \R\ );</p>
  </div>
  <div class="paragraph">
  <p>substitute( subcomponent_separator, \T\ );</p>
  </div>
  <div class="paragraph">
  <p>substitute (truncation_character, \P\ ) /<strong>See 2.6.2Truncation Character escape</strong>/</p>
  </div>
  <div class="paragraph">
  <p>insert subcomponent;</p>
  </div>
  <div class="paragraph">
  <p>if not last ( populated subcomponent ) insert subcomponent_separator; /* e.g., &amp; */</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>if not last ( populated component ) insert component_separator; /* e.g., ^ */</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>return;</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="sect3">
  <h4 id="_message_construction_flow_chart">Message Construction Flow Chart</h4>
  <div class="paragraph">
  <p>The flow charts on the following pages represent another view of the message construction rules. The first shows the rules for transmitting a message; the second shows transmitting field occurrences.</p>
  </div>
  <div class="imageblock">
  <div class="content">
  <img src="extracted-media/media/image1.wmf" alt="image1">
  </div>
  </div>
  <div class="imageblock">
  <div class="content">
  <img src="extracted-media/media/image2.wmf" alt="image2">
  </div>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_rules_for_the_recipient">Rules for the recipient</h3>
  <div class="paragraph">
  <p>The following rules apply to receiving HL7 messages and converting their contents to data values:</p>
  </div>
  <div class="paragraph">
  <p>a) ignore segments, fields, components, subcomponents, and extra repetitions of a field that are present but were not expected.</p>
  </div>
  <div class="paragraph">
  <p>b) treat optional segments that were expected but are not present as consisting entirely of fields that are not present.</p>
  </div>
  <div class="paragraph">
  <p>c) treat fields and components that are expected but were not included in a segment as not present.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_encoding_rules_notes">Encoding rules notes</h3>
  <div class="paragraph">
  <p>If a segment is to be continued across messages, use the extended encoding rules. These rules are defined in terms of the more general message continuation protocol (see Section <em>2.9.2</em>, "<em>Continuation messages and segments</em>").</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_use_of_escape_sequences_in_fields">Use of escape sequences in fields</h2>
  <div class="sectionbody">
  <div class="sect2">
  <h3 id="_formatting_codes">Formatting codes</h3>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 8. When delimiters are included in any component, the delimiters SHALL be escaped. Failure to do so can alter the meaning of the component. The escape character is whichever ASCII character is specified in the &lt;escape character&gt; component of MSH-2 Encoding Characters. For purposes of this section, the character \ will be used to represent the character so designated in a message. An escape sequence consists of the escape character followed by an escape code ID of one character, zero (0) or more data characters, and another occurrence of the escape character. The following escape sequences are defined:</caption>
  <colgroup>
  <col style="width: 21%;">
  <col style="width: 79%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\F\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">field separator</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\S\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">component separator</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\T\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">subcomponent separator</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\R\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">repetition separator</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\E\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">escape character</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\P\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">truncation character</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>When a field, component or sub-component of type TX, FT, or CF is being encoded, additional escape character(s) MAY be used to signal certain special characteristics of portions of the text field. The escape character is whatever display ASCII character is specified in the &lt;escape character&gt; component of MSH-2 Encoding Characters.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 9. The following additional escape sequences are defined:</caption>
  <colgroup>
  <col style="width: 21%;">
  <col style="width: 79%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\H\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">start highlighting</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\N\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">normal text (end highlighting)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\Xdddd&#8230;&#8203;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">hexadecimal data</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\Zdddd&#8230;&#8203;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">locally defined escape sequence</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>Escape sequences SHALL NOT contain nested escape sequences.</p>
  </div>
  <div class="paragraph">
  <p>For the purposes of determining length, all the characters inside the escape (all between the opening and closing \, not including the \ symbols themselves) count towards the length. This applies to all the escape sequences, including the formatting ones described below.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_truncation_character_escape">Truncation Character escape</h3>
  <div class="paragraph">
  <p>When the last character of a value that is expected to be truncated is the truncation character, the truncation character SHALL be escaped.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 10. Examples of truncation character usage.</caption>
  <colgroup>
  <col style="width: 34%;">
  <col style="width: 33%;">
  <col style="width: 33%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">Conformance length</th>
  <th class="tableblock halign-left valign-top">Original value</th>
  <th class="tableblock halign-left valign-top">Component value</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">6#</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcdefgh</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcde#</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">6#</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcdef</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcdef</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">6#</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcde#</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">abcde\P\</p></td>
  </tr>
  </tbody>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_escape_sequences_supporting_multiple_character_sets">Escape sequences supporting multiple character sets</h3>
  <div class="paragraph">
  <p>The following HL7 escape sequences are defined to support multiple character sets for fields, components and sub-components that are defined as data types FT, ST, and TX. They allow HL7 parsers to use escape codes (defined in the standards used below), without breaking, and without being non-conformant to the HL7 escape paradigm defined in this section.</p>
  </div>
  <div class="paragraph">
  <p>\Cxxyy\ single-byte character set escape sequence with two hexadecimal values, xx and yy, that indicate the escape sequence defined for one of the character repertoires supported for the current message (i.e., ISO-IR xxx).</p>
  </div>
  <div class="paragraph">
  <p>\Mxxyyzz\ multi-byte character set escape sequence with three hexadecimal values, xx, yy and zz. zz is optional.</p>
  </div>
  <div class="paragraph">
  <p>Common character set escape sequences include the following which are defined in the standards mentioned:</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 11. Single-byte character sets:</caption>
  <colgroup>
  <col style="width: 32%;">
  <col style="width: 68%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2842\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR6 G0 (ISO 646 : ASCII)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D41\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR100 (ISO 8859 : Latin Alphabet 1)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D42\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR101 (ISO 8859 : Latin Alphabet 2)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D43\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR109 (ISO 8859 : Latin Alphabet 3)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D44\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR110 (ISO 8859 : Latin Alphabet 4)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D4C\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR144 (ISO 8859 : Cyrillic)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D47\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR127 (ISO 8859 : Arabic)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D46\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR126 (ISO 8859 : Greek)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D48\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR138 (ISO 8859 : Hebrew)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2D4D\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR148 (ISO 8859 : Latin Alphabet 5)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C284A\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR14 (JIS X 0201 -1976: Romaji)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\C2949\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR13 (JIS X 0201 : Katakana)</p></td>
  </tr>
  </tbody>
  </table>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 12. Multi-byte codes:</caption>
  <colgroup>
  <col style="width: 31%;">
  <col style="width: 69%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\M2442\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR87 (JIS X 0208 : Kanji, hiragana and katakana)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\M242844\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ISO-IR159 (JIS X 0212 : Supplementary Kanji)</p></td>
  </tr>
  </tbody>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_highlighting">Highlighting</h3>
  <div class="paragraph">
  <p>In designating highlighting, the sending application is indicating that the characters that follow somehow can be made to stand out, but leaving the method of doing so to the receiving application. Depending on device characteristics and application style considerations, the receiving application MAY choose reverse video, boldface, underlining, blink, an alternate color or another means of highlighting the displayed data. For example the message fragment:</p>
  </div>
  <div class="paragraph">
  <p>DSP| TOTAL CHOLESTEROL \H\240*\N\ [90 - 200]</p>
  </div>
  <div class="paragraph">
  <p>might cause the following data to appear on a screen or report:</p>
  </div>
  <div class="paragraph">
  <p>TOTAL CHOLESTEROL 240* [90 - 200]</p>
  </div>
  <div class="paragraph">
  <p>whereas another system might choose to show the 240* in red.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_special_character">Special character</h3>
  <div class="paragraph">
  <p>The special character escape sequences (\F\, \S\, \R\, \T\, \P\ and \E\) allow the corresponding characters to be included in the data in a text field, though the actual characters are reserved. For example, the message fragment</p>
  </div>
  <div class="paragraph">
  <p>DSP| TOTAL CHOLESTEROL 180 \F\90 - 200\F\</p>
  </div>
  <div class="paragraph">
  <p>DSP| \S\----------------\S\</p>
  </div>
  <div class="paragraph">
  <p>would cause the following information to be displayed, given suitable assignment of separators:</p>
  </div>
  <div class="paragraph">
  <p>TOTAL CHOLESTEROL 180 |90 - 200|</p>
  </div>
  <div class="paragraph">
  <p><sup>----------------</sup></p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_hexadecimal">Hexadecimal</h3>
  <div class="paragraph">
  <p>When the hexadecimal escape sequence (\Xdddd&#8230;&#8203;\) is used the X SHALL be followed by 1 or more pairs of hexadecimal digits (0, 1, . . . , 9, A, . . . , F). Consecutive pairs of the hexadecimal digits represent 8-bit binary values. The interpretation of the data is entirely left to an agreement between the sending and receiving applications that is beyond the scope of this Standard.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_usage_and_examples_of_formatted_text">Usage and Examples of Formatted Text</h3>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 13. If the field is of the formatted text (FT) data type, formatting commands also SHALL be surrounded by the escape character. Each command begins with the "." (period) character. The following formatting commands are available:</caption>
  <colgroup>
  <col style="width: 18%;">
  <col style="width: 82%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.sp &lt;number&gt;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">End current output line and skip &lt;number&gt; vertical spaces. &lt;number&gt; is a positive integer or absent. If &lt;number&gt; is absent, skip one space. The horizontal character position remains unchanged. Note that only for purposes of compatibility with previous versions of HL7, "^\.sp\" is equivalent to "\.br\."</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.br\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Begin new output line. Set the horizontal position to the current left margin and increment the vertical position by 1.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.fi\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Begin word wrap or fill mode. This is the default state. It can be changed to a no-wrap mode using the .nf command.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.nf\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Begin no-wrap mode.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.in &lt;number&gt;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Indent &lt;number&gt; of spaces, where &lt;number&gt; is a positive or negative integer. This command cannot appear after the first printable character of a line.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.ti &lt;number&gt;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Temporarily indent &lt;number&gt; of spaces where number is a positive or negative integer. This command cannot appear after the first printable character of a line.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.sk &lt; number&gt;\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Skip &lt;number&gt; spaces to the right.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\.ce\</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">End current output line and center the next line.</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>The component separator that marks each line defines the extent of the temporary indent command (.ti), and the beginning of each line in the no-wrap mode (.nf). Examples of formatting instructions that are NOT included in this data type include: width of display, position on page or screen, and type of output devices.</p>
  </div>
  <div class="paragraph">
  <p>Figure 2-3 is an example of the FT data type from a radiology impression section of a radiology report:</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 14. Figure 2-3. Formatted text as transmitted</caption>
  <colgroup>
  <col style="width: 100%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">| \.in+4\\.ti-4\ 1. The cardiomediastinal silhouette is now within normal limits.\.br\\.ti-4\ 2. Lung fields show minimal ground glass appearance.\.br\\.ti-4\ 3. A loop of colon visible in the left upper quadrant is distinctly abnormal with the appearance of mucosal effacement suggesting colitis.\.br\.in-4\|</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>Figure 2-4 shows one way of presenting the data in Figure 2-3. The receiving system can create many other interpretations by varying the right margin.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 15. Figure 2-4. Formatted text in one possible presentation</caption>
  <colgroup>
  <col style="width: 100%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
  <p>1. The cardiomediastinal silhouette is now within normal limits.</p>
  </div>
  <div class="paragraph">
  <p>2. Lung fields show minimal ground glass appearance.</p>
  </div>
  <div class="paragraph">
  <p>3. A loop of colon visible in the left upper quadrant is distinctly abnormal with the appearance of mucosal effacement suggesting colitis.</p>
  </div></div></td>
  </tr>
  </tbody>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_local">Local</h3>
  <div class="paragraph">
  <p>When the local escape sequence (\Zdddd&#8230;&#8203;\) is used the Z SHALL be followed by characters that are valid in a TX field. The interpretation of the data is entirely left to an agreement between the sending and receiving applications that is beyond the scope of this Standard.</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_version_compatibility_definition">Version compatibility definition</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The rules, described in section <em>2.5</em>, <em>Message construction rules,</em> for receiving HL7 messages and converting their contents to data values allow the following definition of a backward compatibility requirement between the 2.x versions of HL7:</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  If an issue is not covered explicitly under these rules, no assumption SHOULD be made that the change is allowed.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The keys to understanding version compatibility are the following 2 axioms, plus the processing rules which state that unexpected information SHOULD be discarded.</p>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>Old receivers receiving new messages SHOULD be able to continue receiving messages without error.</p>
  </li>
  <li>
  <p>New receivers SHOULD be able to understand old messages.</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>This section elaborates on what the kinds of changes can be done that satisfies these axioms. Only HL7 changes introduced in new versions are included. Local extensions are discussed in section <em>2.10</em>, "<em>Local Extension</em>".</p>
  </div>
  <div class="sect2">
  <h3 id="_adding_messages_or_message_constituents">Adding messages or message constituents</h3>
  <div class="paragraph">
  <p>When a new message or a new constituent of an HL7 message is introduced it SHALL be defined as described below. A sending system SHOULD be able to send a new message or new constituent; the receiver, regardless of its version level, SHALL ignore any message or message constituent it is not expecting without generating an application failure. This does not preclude a receiver notifying the sender that additional element was ignored, but the receiving application SHOULD NOT fail just from the existence of additional element.</p>
  </div>
  <div class="paragraph">
  <p>a) New messages MAY be introduced.</p>
  </div>
  <div class="paragraph">
  <p>b) A new segment group MAY be defined.</p>
  </div>
  <div class="paragraph">
  <p>c) As of V2.5 the first segment in a newly-defined segment group SHALL be marked as required.</p>
  </div>
  <div class="paragraph">
  <p>d) New segments MAY be introduced to an existing message. In general these SHOULD be introduced at the end of a message or a segment group, but they MAY be introduced elsewhere within the message if the segment hierarchy makes this necessary. Unless needed as a technical correction or for regulatory reporting purposes, a new segment SHALL NOT be added to a deprecated message. As of v2.6 all new segments, except for those pertaining only to message transmission or control, SHALL include an Action Code field as the first or second field as appropriate.</p>
  </div>
  <div class="paragraph">
  <p>e) Care must be taken when introducing a new segment if this results in a situation in which a named segment X appears in two individual or group locations. See section <em>2.5</em>, "<em>Message construction rules</em>".</p>
  </div>
  <div class="paragraph">
  <p>f) New fields MAY be added at the end of a segment. A field that changes the semantic meaning of a segment (e.g., an Acton Code, or Mood code) SHALL only be introduced in a pre-existing segment if the usage of the field is conditional on it not being used in messages with pre-existing trigger events. This is to avoid the risk of reversing the intent of the segment as it is known to the recipient of an earlier version. For example, if the Sender were to send the segment with a delete action code, the recipient would not understand that the information SHOULD be deleted.</p>
  </div>
  <div class="paragraph">
  <p>g) A new data type MAY be introduced.</p>
  </div>
  <div class="paragraph">
  <p>h) New components MAY be added at the end of a data type.</p>
  </div>
  <div class="paragraph">
  <p>i) A new table MAY be introduced.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_changing_messages_or_message_constituents">Changing messages or message constituents</h3>
  <div class="paragraph">
  <p>Allowable changes to messages or message constituents can be categorized as name, data type, optionality, repeatability, length or definition changes.</p>
  </div>
  <div class="paragraph">
  <p>a) The descriptive text name of a message or message constituent (except for segment group name) MAY be changed. This is not expected to have impact on either the sender&#8217;s ability to transmit a message or the receiver&#8217;s ability to receive and understand the message. Reasons for changing the descriptive text name include: 1) clarify a misleading name, and 2) encompassing a broader use without jeopardizing current use.</p>
  </div>
  <div class="paragraph">
  <p>b) The data type of a field or data type component MAY be changed. A sending system SHOULD be able to send the modified field or data type; the receiver, regardless of its version level, SHOULD be able to understand the message and to ignore any message constituent it is not expecting.</p>
  </div>
  <div class="paragraph">
  <p>1) The data type of the field MAY be changed provided that the components of the new data type have the same structure and interpretation as the old data type. For example, an IS data type MAY be changed to a CE, but a PPN data type cannot be changed to a PN. An NM data type cannot be changed to an ST data type.</p>
  </div>
  <div class="paragraph">
  <p>2) For existing fields in existing segments, data types MAY be changed if the leftmost (prior version) part of the field has the same meaning as it had in the prior version of HL7. This is in accordance with the rules governing the addition of new components and subcomponents described in the section above. In other words, if the new parts of the field (those that are part of the new data type) are ignored, what remains is the old field (defined by the old data type), which has the same meaning as it had in the prior version of HL7.</p>
  </div>
  <div class="paragraph">
  <p>3) If a data type component has its data type changed, the structure and interpretation SHALL remain the same as the pre-existing component. Any new component is added at the end of the data type.</p>
  </div>
  <div class="paragraph">
  <p>c) The optionality of a message constituent MAY be changed. A sending system SHOULD be able to send the modified field; the receiver, regardless of its version level, SHOULD be able to understand the message. This pertains as follows:</p>
  </div>
  <div class="paragraph">
  <p>1) Existing optional segment groups MAY be made required.</p>
  </div>
  <div class="paragraph">
  <p>2) Existing optional segments MAY be made conditional or required.</p>
  </div>
  <div class="paragraph">
  <p>3) Existing optional fields MAY be made conditional or required.</p>
  </div>
  <div class="paragraph">
  <p>4) Existing required fields MAY be made conditional if a new trigger event has been applied. The condition must be specified such that the field remains required for the pre-existing trigger events.</p>
  </div>
  <div class="paragraph">
  <p>5) Existing optional components of a data type MAY be made conditional or required.</p>
  </div>
  <div class="paragraph">
  <p>d) The repeatability of a message constituent MAY be changed. A sending system SHOULD be able to send the modified message constituent; the receiver, regardless of its version level, SHOULD be able to understand the message. Note that if a non-repeating message constituent is made repeating, information sent in the new repetitions couldbe lost to the recipient who is not expecting them.</p>
  </div>
  <div class="paragraph">
  <p>If HL7 has given, or will give, semantic meaning to the first instance, to allow backward compatibility, the first instance of the repeating constituent SHALL have the same meaning as the non-repeating constituent had in the prior version of HL7. In this way, a receiving application that interprets the message based upon the prior standard would continue to find the same intent communicated in the message.</p>
  </div>
  <div class="paragraph">
  <p>If HL7 has not given, and will/can not give, semantic meaning to the first instance, and one or more implementation-applied business rules exist to select one of several occurrences to populate a non-repeating constituent, those same rules SHOULD be applied when a newer version of the standard allows for repetition of the constituent. By applying the prior business rules to determine the first occurrence of a repeating constituent, a receiving application that interprets the message based upon the prior standard would continue to find the same intent communicated in the message.</p>
  </div>
  <div class="paragraph">
  <p>If, in the judgment of the owner/author of the standard section in question, changing a message constituent from non-repeating to repeating poses logical, parsing, business, or other compatibility issues, the owner/author SHOULD create a new structure to eliminate the compatibility concern.</p>
  </div>
  <div class="paragraph">
  <p>For example, if allowing a segment to repeat implies a change to the business intent of the message, the work group(s) responsible SHOULD define a new message structure (as a new message/trigger) and retain the old structure for backward compatibility.</p>
  </div>
  <div class="paragraph">
  <p>This pertains as follows:</p>
  </div>
  <div class="paragraph">
  <p>1) A segment group MAY change from non-repeating to repeating, subject to the backward compatibility concerns expressed above.</p>
  </div>
  <div class="paragraph">
  <p>2) A segment group SHALL NOT be changed from repeating to non-repeating.</p>
  </div>
  <div class="paragraph">
  <p>3) A segment MAY be changed from non-repeating to repeating, subject to the backward compatibility concerns expressed above.</p>
  </div>
  <div class="paragraph">
  <p>4) A segment SHALL NOT be changed from repeating to non-repeating.</p>
  </div>
  <div class="paragraph">
  <p>5) A field MAY be changed from non-repeating to repeating, subject to the backward compatibility concerns expressed above. A field SHALL NOT be changed from repeating to non-repeating.</p>
  </div>
  <div class="paragraph">
  <p>e) The minimum and maximum normative lengths and the conformance length and truncation status of each field or data type component MAY be changed between versions. .</p>
  </div>
  <div class="paragraph">
  <p>f) Table definition MAY change.</p>
  </div>
  <div class="paragraph">
  <p>1) A table MAY be changed from user-defined to HL7 defined or externally defined.</p>
  </div>
  <div class="paragraph">
  <p>2) A table MAY be changed from HL7 defined to an externally defined table. When this occurs, the data type of the field SHOULD be changed to a CNE or CWE.</p>
  </div>
  <div class="paragraph">
  <p>3) A table MAY be changed from HL7 defined published in Chapter 2c to HL7 Defined sourced externally (HL7-EXT).</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_deprecating_messages_or_message_constituents">Deprecating messages or message constituents</h3>
  <div class="paragraph">
  <p>Any required, optional or conditional constituent of an HL7 message, including the message itself, MAY be deprecated. This means that one of the following situations has occurred:</p>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>The message or message constituent no longer has a meaningful purpose</p>
  </li>
  <li>
  <p>The message or message constituent has been replaced by a better method</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>Language will be inserted stating the fact of deprecation, the version in which the deprecation occurred, and what message or message constituent, if any, replaces it. The phrase "Retained for backward compatibility only in version 2.x; refer to section n.m instead" will be the standard language for such an occurrence.</p>
  </div>
  <div class="paragraph">
  <p>The fact of deprecation SHOULD NOT affect either the sender or the receiver because the message or message constituent is retained for backward compatibility. Implementers, by site agreement, MAY agree to not support deprecated message constituents.</p>
  </div>
  <div class="paragraph">
  <p>The following are allowed:</p>
  </div>
  <div class="paragraph">
  <p>a) A message MAY be deprecated.</p>
  </div>
  <div class="paragraph">
  <p>c) A trigger event MAY be deprecated.</p>
  </div>
  <div class="paragraph">
  <p>d) A message structure MAY be deprecated.</p>
  </div>
  <div class="paragraph">
  <p>e) A segment in an existing message MAY be deprecated. Implementers, by site agreement, MAY agree to not support deprecated segments. If the segment that is to be deprecated has dependents the entire segment group SHALL be deprecated. For example, in a group [\{ABC[DEF][{GHI}]], DEF and/or GHI MAY be deprecated, but ABC cannot be deprecated without deprecating the whole.</p>
  </div>
  <div class="paragraph">
  <p>f) A field MAY be deprecated by HL7. Before deprecating a field, HL7 SHALL ensure that all message structures which use that field have an appropriate non-deprecated location to move the data. Implementers, by site agreement, MAY agree to not use deprecated fields.</p>
  </div>
  <div class="paragraph">
  <p>g) A data type MAY be deprecated provided all fields referencing it have been deprecated or there is an explicit statement that the data type is not to be used in any field defined in the future.</p>
  </div>
  <div class="paragraph">
  <p>h) A data type component MAY be deprecated.</p>
  </div>
  <div class="paragraph">
  <p>i) A table MAY be deprecated. This includes HL7 tables, HL7-EXT tables, user-defined tables, imported external tables and reference to external tables. Before deprecating a table, HL7 SHALL ensure that no references to the table exist.</p>
  </div>
  <div class="paragraph">
  <p>j) An entry in an HL7-defined table MAY be deprecated. The table itself SHOULD be reviewed if it contains a substantial number of deprecated members.</p>
  </div>
  <div class="paragraph">
  <p>k) An entry in an imported external table SHALL <strong>NOT</strong> be deprecated.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_removing_messages_or_message_constituents">Removing messages or message constituents</h3>
  <div class="paragraph">
  <p>A message or message constituent MAY be removed from the standard when criteria described in this section are met. HL7 will track old names so they are not re-used.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  To refer to the detail of a withdrawn message constituent, the reader will need to review the appropriate earlier version of the standard. By site agreement senders and receivers MAY agree to continue to use messages and/or message constituents that have been removed.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>a) A message constituent MAY be immediately removed from the standard based on the following criteria (immediately means in the same version in which the criteria are met.).</p>
  </div>
  <div class="paragraph">
  <p>1) A message structure MAY be removed immediately provided no message references it in the standard. Care must be taken lest a message structure is prematurely removed if the associated trigger event that contributed to its name is removed. For example, if a message structure ABC_D01 is associated with trigger events D01, D02 and D03 and D01 is changed and becomes associated with another existing message structure DEF_E01, the message structure ABC_D01 is still active and valid for trigger events D02 and D03.</p>
  </div>
  <div class="paragraph">
  <p>2) A segment MAY be removed immediately provided no message references it in the standard.</p>
  </div>
  <div class="paragraph">
  <p>3) A data type MAY be removed immediately provided no fields reference it. This occurs when the data type for a field is changed to a new data type that incorporates the components of the old one.</p>
  </div>
  <div class="paragraph">
  <p>4) A table MAY be deprecated provided all fields and components, where the table has been used have been removed. This applies to HL7, user-defined and external tables. It is recognized that this might have a ripple effect.</p>
  </div>
  <div class="paragraph">
  <p>b) A message constituent, except as noted in points c, d and e below, will be withdrawn and removed, no sooner than, after 2 versions in a deprecated state. For example, if a message was originally deprecated in v 2.3.1, its definition can be removed when v 2.6 is published.</p>
  </div>
  <div class="paragraph">
  <p>1) A message type and its definition MAY be removed.</p>
  </div>
  <div class="paragraph">
  <p>2) A trigger event and its definition MAY be removed.</p>
  </div>
  <div class="paragraph">
  <p>3) A segment group in an existing message MAY be removed.</p>
  </div>
  <div class="paragraph">
  <p>4) A segment in an existing message MAY be removed.</p>
  </div>
  <div class="paragraph">
  <p>c) A deprecated field in an existing segment SHALL NOT be removed from the standard. However, no sooner than, after 2 versions in a deprecated state, the field will be marked as withdrawn and all explanatory narrative will be removed</p>
  </div>
  <div class="paragraph">
  <p>d) A deprecated component in an existing data type SHALL NOT be removed from the standard. However, no sooner than, after 2 versions in a deprecated state, the component will be marked as withdrawn and all explanatory narrative will be removed.</p>
  </div>
  <div class="paragraph">
  <p>e) A deprecated member of an existing HL7 table SHALL NOT be removed from the standard. However, no sooner than, after 2 versions in a deprecated state, the table member will be marked as withdrawn and all explanatory narrative will be removed from the description and comment column.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_early_adoption_of_hl7_changes">Early adoption of HL7 changes</h3>
  <div class="paragraph">
  <p>Early adoption of HL7 changes that have been approved by the technical committee for the next membership ballot is a common practice and is not prohibited, but carries risk. Such changes MAY be rejected or modified in the balloting process. One example is that the change might pass but MAY be positioned differently in the segment or data type.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_technical_correction_rules">Technical correction rules</h3>
  <div class="paragraph">
  <p>Technical corrections MAY be applied between versions on a case-by-case basis. These corrections SHALL be published on the HL7 website. The following meet criteria for technical correction:</p>
  </div>
  <div class="paragraph">
  <p>a) Spelling correction</p>
  </div>
  <div class="paragraph">
  <p>b) Incorrect section reference</p>
  </div>
  <div class="paragraph">
  <p>c) Transcription error in an imported external table</p>
  </div>
  <div class="paragraph">
  <p>d) Correction of an inconsistency between a segment attribute table and the field narrative</p>
  </div>
  <div class="paragraph">
  <p>e) Erroneous examples</p>
  </div>
  <div class="paragraph">
  <p>f) Erroneous/misleading descriptions</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_message_processing_rules">Message Processing Rules</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The processing rules described here apply to all exchanges of messages, whether or not the HL7 encoding rules or Lower Layer Protocols are used. They represent the primary message processing mode. The user MAY use either the original processing rules, described in section <em>2.8.2</em>, "<em>Message response using the original processing rules</em>", or -the enhanced processing rules, described in section <em>2.8.3</em>, "<em>Response using enhanced acknowledgment</em>" . The original mode and the enhanced mode serve different purposes.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The MCF – Delayed Acknowledgment message has been removed from the standard. It was deprecated in v 2.2. Accordingly, the narrative notes regarding deferred processing have been removed from this section.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>Certain variants exist and are documented elsewhere:</p>
  </div>
  <div class="paragraph">
  <p>a) an optional sequence number protocol. Refer to section <em>2.9.1</em>, "<em>Sequence number protocol</em>".</p>
  </div>
  <div class="paragraph">
  <p>b) an optional protocol for continuing a very long message. Refer to section <em>2.9.2</em>, "<em>Continuation messages and segments</em>".</p>
  </div>
  <div class="paragraph">
  <p>Because the protocol describes an exchange of messages, it is described in terms of two entities, the initiating and responding systems. Each is both a sender and receiver of messages. The initiating system sends first and then receives, while the responding system receives and then sends.</p>
  </div>
  <div class="paragraph">
  <p>In overview this exchange proceeds as follows:</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 16. Message Exchange</caption>
  <colgroup>
  <col style="width: 14%;">
  <col style="width: 46%;">
  <col style="width: 40%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Step</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Process</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Comment</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Step 1</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Initiator constructs an HL7 message from application data and sends it to the responding system</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Step 2</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Responder receives message and processes it based on rules</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">The rules differ based on whether the original acknowledge mode or the enhanced acknowledgment mode is followed</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Step 3</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Responder sends response message</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Step 4</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Initiator processes response message</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <div class="sect2">
  <h3 id="_message_initiation">Message initiation</h3>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 17. The initiating application creates a message with data values as defined in the appropriate chapter of this Standard. The fields shown below SHOULD be valued in the MSH segment (as defined under the MSH segment definition of this chapter). The message is encoded according to the applicable rules and sent to the lower level protocols, which will attempt to deliver it to the responding application. (For definitions of the MSH fields see Section <em>2.13.9</em>, "<em>MSH ‑ Message Header segment</em>")</caption>
  <colgroup>
  <col style="width: 31%;">
  <col style="width: 69%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">Field</th>
  <th class="tableblock halign-left valign-top">Notes</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-3-sending application</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-4-sending facility</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-5-receiving application</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-6-receiving facility</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-7-date/time of message</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-9-message type</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-10-message control ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Unique identifier used to relate the response to the initial message.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-11-processing ID</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-12-version ID</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-13-sequence number</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-14-continuation pointer</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Used in implementation of message continuation protocol. See Section <em>2.9.2</em>, "<em>Continuation messages and segments</em>". Also see chapter 5, "Queries".</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>Certain other fields in the MSH segment are required for the operation of the HL7 encoding rules; they will not be relevant if other encoding rules are employed.</p>
  </div>
  <div class="paragraph">
  <p>The event code in the second component of link:#_MSH-9<em>_Message Type  (MSG)   00009[MSH-9 Message Type] is redundantly shown elsewhere in some messages. For example, the same information is in the EVN segment of the ADT message. This is for compatibility with prior versions of the HL7 protocol. Newly defined messages SHOULD only show the event code in link:#_MSH-9</em>_Message Type  (MSG)   00009[MSH-9 Message Type].</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_response_using_the_original_processing_rules">Message response using the original processing rules</h3>
  <div class="sect3">
  <h4 id="_accept_and_validate_the_message_in_responding_system">Accept and validate the message in responding system</h4>
  <div class="paragraph">
  <p>Upon receipt of the message, when the Original Acknowledgment rules are used, the protocol software in the responding system validates it against at least the following criteria:</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Both MSH-15 - accept acknowledgment type and MSH-16 - application acknowledgment type are not present.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>a) the value in link:#_MSH-9___Message Type  (MSG)   00009[MSH-9 Message Type] is one that is acceptable to the receiver.</p>
  </div>
  <div class="paragraph">
  <p>b) the value in link:#_MSH-12___Version ID  (VID)   00012[MSH-12 Version ID] is acceptable to the receiver.</p>
  </div>
  <div class="paragraph">
  <p>c) the value in link:#_MSH-11___Processing ID  (PT)   0001[MSH-11 Processing ID] is appropriate for the application process handling the message.</p>
  </div>
  <div class="paragraph">
  <p>If any of these edits fail, the protocol software rejects the message. That is, it creates an ACK message with <strong>AR</strong> in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code].</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  If the Acknowledgment Code is other than AA, the reason(s) for the rejection SHOULD be sent in the ERR segment(s) to notify the sender of the exact problem.*
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>If successful, the process moves to the next step.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_accept_and_validateprocess_the_message_in_the_receiving_application">Accept and validate/process the message in the receiving application</h4>
  <div class="paragraph">
  <p>Upon successful validation by the responding system, the message is passed to the receiving application, which performs one of these functions:</p>
  </div>
  <div class="paragraph">
  <p>a) process the message successfully, generating the functional response message with a value of <strong>AA</strong> in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code].</p>
  </div>
  <div class="paragraph">
  <p>b) send an error response, providing error information in functional segments to be included in the response message with a value of <strong>AE</strong> in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code].</p>
  </div>
  <div class="paragraph">
  <p>c) fail to process (reject) the message for reasons unrelated to its content or format (system down, internal error, etc.). For most such problems it is likely that the responding system will be able to accept the same message at a later time. The implementers must decide on an application-specific basis whether the message SHOULD be automatically sent again. The response message contains a value of <strong>AR</strong> in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code].</p>
  </div>
  <div class="paragraph">
  <p>The MSH segment in the response is constructed anew following the rules used to create the initial message described above. In particular, link:#_MSH-7<em>_Date/Time Of Message  (DTM)[MSH-7 Date/Time of Message] and link:#_MSH-10</em>_Message Control ID  (ST)  [MSH-10 Message Control ID] refer to the response message; they are not echoes of the fields in the initial message. link:#_MSH-5<em>_Receiving Application  (HD)[MSH-5 Receiving Application], link:#_MSH-6</em>_Receiving Facility  (HD)   [MSH-6 Receiving Facility], and link:#_MSH-11<em>_Processing ID  (PT)   0001[MSH-11 Processing ID] contain codes that are copied from link:#_MSH-3</em>_Sending Application  (HD)  [MSH-3 Sending Application], link:#_MSH-4<em>_Sending Facility  (HD)   00[MSH-4 Sending Facility] and link:#_MSH-11</em>_Processing ID  (PT)   0001[MSH-11 Processing ID] in the initiating message.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 18. In all the responses described above, the following values are put in the MSA segment. Note that the field definitions for the MSA segment fields are in Section <em>2.13.8</em>, "<em>MSA ‑ Message Acknowledgment segment</em>".</caption>
  <colgroup>
  <col style="width: 36%;">
  <col style="width: 64%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Notes</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-1-acknowledgment code</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">As described above.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-2-message control ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-10-message control ID from MSH segment of incoming message.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-4-expected sequence number</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">As described in Section <em>2.9.1</em>, "<em>Sequence number protocol</em>," (if the sequence number protocol is being used).</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ERR segment fields</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Refer to section 2.13.5 <a href="#err-error-segment">ERR - error segment</a>.</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>The receiving application then passes the response message back to the responding system for the next step in the process.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_transmit_the_response_message">Transmit the response message</h4>
  <div class="paragraph">
  <p>Upon receiving the response message from the receiving application, the responding system transmits it to the initiating system.</p>
  </div>
  <div class="paragraph">
  <p>The initiator processes the response message.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_original_mode_flow_chart">Original Mode flow chart</h4>
  <div class="imageblock">
  <div class="content">
  <img src="extracted-media/media/image3.png" alt="image3">
  </div>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_response_using_enhanced_acknowledgment">Response using enhanced acknowledgment</h3>
  <div class="paragraph">
  <p>a) the responding system receives the message and commits it to safe storage. This means that the responding system accepts the responsibility for the message in a manner that releases the sending system from any obligation to resend the message. The responding system now checks the message header record to determine whether or not the initiating system requires an accept acknowledgment message indicating successful receipt and secure storage of the message. If it does, the accept acknowledgment message is constructed and returned to the initiator.</p>
  </div>
  <div class="paragraph">
  <p>b) at this point, the requirements of the applications involved in the interface determine whether or not more information needs to be exchanged. This exchange is referred to as an application acknowledgment and includes information ranging from simple validation to a complex application-dependent response. If the receiving system is expected to return application-dependent information, it initiates another exchange when this information is available. This time, the roles of initiator and responder are reversed.</p>
  </div>
  <div class="sect3">
  <h4 id="_accept_and_validate_the_message_in_responding_system_2">Accept and validate the message in responding system</h4>
  <div class="paragraph">
  <p>Upon receipt of the message, , the protocol software in the responding system makes an initial determination as to whether or not the message can be accepted, based on factors such as:</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Both MSH-15-accept acknowledgment type and MSH-16-application acknowledgment type SHALL BE valued.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>a) the status of the interface</p>
  </div>
  <div class="paragraph">
  <p>b) the availability of safe storage onto which the message can be saved</p>
  </div>
  <div class="paragraph">
  <p>c) the syntactical correctness of the message, if the design of the receiving system includes this type of validation at this phase</p>
  </div>
  <div class="paragraph">
  <p>d) the values of link:#_MSH-9<em>_Message Type  (MSG)   00009[MSH-9 Message Type], <a href="#msh-12-version-id-vid-00012">MSH-12 Version ID</a>, and link:#_MSH-11</em>_Processing ID  (PT)   0001[MSH-11 Processing ID], if the design of the receiving system includes this type of validation at this phase</p>
  </div>
  <div class="paragraph">
  <p>It then examines the Message Header segment (MSH) to determine whether or not the initiating system requires an accept acknowledgment.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_transmit_general_acknowledgment_message">Transmit general acknowledgment message</h4>
  <div class="paragraph">
  <p>A general acknowledgment message is not always required by the initiating system, but if it is the responding system sends one of the following:</p>
  </div>
  <div class="paragraph">
  <p>a) a commit accept (CA) in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code] if the message can be accepted for processing</p>
  </div>
  <div class="paragraph">
  <p>b) a commit reject (CR) in link:#_MSA-1<em>_Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code] if the one of the values of link:#_MSH-9</em>_Message Type  (MSG)   00009[MSH-9 Message Type], <a href="#msh-12-version-id-vid-00012">MSH-12 Version ID</a> or link:#_MSH-11___Processing ID  (PT)   0001[MSH-11 Processing ID] is not acceptable to the receiving application</p>
  </div>
  <div class="paragraph">
  <p>c) a commit error (CE) in link:#_MSA-1___Acknowledgment Code  (ID)  [MSA-1 Acknowledgment Code] if the message cannot be accepted for any other reason (e.g., sequence number error)</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  If the Acknowledgment Code is other than CA, the reason(s) for the rejection SHOULD be sent in the ERR segment(s) to notify the sender of the exact problem.*
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The MSH segment in the response is constructed anew following the rules used to create the initial message described above. In particular, link:#_MSH-7<em>_Date/Time Of Message  (DTM)[MSH-7 Date/Time of Message] and link:#_MSH-10</em>_Message Control ID  (ST)  [MSH-10 Message Control ID] refer to the response message; they are not echoes of the fields in the initial message. link:#_MSH-5<em>_Receiving Application  (HD)[MSH-5 Receiving Application], link:#_MSH-6</em>_Receiving Facility  (HD)   [MSH-6 Receiving Facility], and link:#_MSH-11<em>_Processing ID  (PT)   0001[MSH-11 Processing ID] contain codes that are copied from link:#_MSH-3</em>_Sending Application  (HD)  [MSH-3 Sending Application], link:#_MSH-4<em>_Sending Facility  (HD)   00[MSH-4 Sending Facility] and link:#_MSH-11</em>_Processing ID  (PT)   0001[MSH-11 Processing ID] in the initiating message.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 19. For this response, the following values are put in the MSA segment. Note that the field definitions for the MSA segment fields are in Section <em>2.13.8</em>, '<em>MSA ‑ Message Acknowledgment segment</em>":</caption>
  <colgroup>
  <col style="width: 35%;">
  <col style="width: 65%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Notes</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-2-message control ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-10-message control ID from the incoming message.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-1-acknowledgment code</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">As described above.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-4-expected sequence number</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">As described in Section <em>2.9.1</em>, "<em>Sequence number protocol</em>" (if the sequence number protocol is being used).</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ERR segment fields</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Refer to section 2.13.5 <a href="#err-error-segment">ERR - error segment</a></p></td>
  </tr>
  </tbody>
  </table>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-15-accept acknowledgment type and MSH-16-application acknowledgment type are not valued (i.e. not present or empty). At this point, the accept portion of this message exchange is considered complete.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_transmit_application_acknowledgment">Transmit application acknowledgment</h4>
  <div class="paragraph">
  <p>If the message header segment indicates that the initiating system also requires an application acknowledgment, this SHALL be returned as the initial message of a later exchange.</p>
  </div>
  <div class="paragraph">
  <p>For this message, the receiving system acts as the initiator. Since the message it sends is application‑specific, the layouts of these application-level response messages are defined in the relevant application-specific chapter. If needed, this application acknowledgment message can itself require (in link:#_MSH-15<em>_Accept Acknowledgment Type[MSH-15 Accept Acknowledgment Type]) an accept acknowledgment message (MSA). link:#_MSH-16</em>_Application Acknowledgment[MSH-16 Application Acknowledgment Type], however, is always NE(Never), since the protocol does not allow the application acknowledgment message to have an application acknowledgment.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 20. For this response, the following values are put in the MSA segment. Note that the field definitions for the MSA segment fields are in Section <em>2.13.8</em>, "<em>MSA ‑ Message Acknowledgment segment</em>".</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 70%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Notes</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-2-message control ID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the initial message from the original initiating system as defined in Section <em>2.8.1</em>, "<em>Message initiation</em>".</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-1-acknowledgment code</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Uses the application (processing) acknowledgment codes as described in Section <em>2.13.8.1</em>.</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA-3-text message</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Text description of error.q</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ERR segment fields</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Refer to section <a href="#err-error-segment">ERR - error segment</a></p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>At this point, the application acknowledgment portion of this message exchange is considered complete.</p>
  </div>
  <div class="paragraph">
  <p>If the processing on the receiving system goes through multiple stages, chapter-defined messages MAY be used to relay status or informational changes to other systems (including the original initiating system). Such messages are not part of the acknowledgment scheme for the original message, but are considered to be independent messages triggered by events on the (original) responding system.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  There is no equivalent to the V2.1 original acknowledgment protocol, where the acknowledgment is always sent as a response on the same communications channel. The enhanced acknowledgment protocol with MSH-15 (accept acknowledgment type) = NE and MSH-16 (application acknowledgment type) = AL still requires that the application acknowledgment is sent on a separate communications channel.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_enhanced_acknowledgment_flow_chart"><span class="image"><img src="extracted-media/media/image4.png" alt="extracted-media/media/image4" width="624" height="677"></span>Enhanced acknowledgment flow chart</h4>
  
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_special_hl7_protocols">Special HL7 Protocols</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>This section contains several extensions to the basic HL7 message protocol. These extensions represent implementation choices, and are to be used on a site-specific and application-specific basis as needed.</p>
  </div>
  <div class="sect2">
  <h3 id="_sequence_number_protocol">Sequence number protocol</h3>
  <div class="paragraph">
  <p>For certain types of data transactions between systems the issue of keeping databases synchronized is critical. An example is an ancillary system such as lab, which needs to know the locations of all inpatients to route stat results correctly. If the lab receives an ADT transaction out of sequence, the census/location information could be incorrect. Although it is true that a simple one-to-one acknowledgment scheme can prevent out-of-sequence transactions between any two systems, only the use of sequence numbers can prevent duplicate transactions.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Although this sequence number protocol is limited to the use of sequence numbers on a single transaction stream between two applications, this sequencing protocol is sufficiently robust to allow the design of HL7-compatible store-and-forward applications.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>a) initial conditions:</p>
  </div>
  <div class="paragraph">
  <p>1) the system receiving the data stream is expected to store the sequence number of the most recently accepted transaction in a secure fashion before acknowledging that transaction. This stored sequence number allows comparison with the next transaction&#8217;s sequence number, and the implementation of fault-tolerant restart capabilities.</p>
  </div>
  <div class="paragraph">
  <p>2) the initiating system keeps a queue of outgoing transactions indexed by the sequence number. The length of this queue must be negotiated as part of the design process for a given link. The minimum length for this queue is one.</p>
  </div>
  <div class="paragraph">
  <p>3) the sequence number is a positive (non-zero) integer; and it is incremented by one (by the initiating system) for each successive transaction.</p>
  </div>
  <div class="paragraph">
  <p>b) starting the link:</p>
  </div>
  <div class="paragraph">
  <p>1) the value of 0 (zero) for a sequence number is reserved: it is allowed only when the initiating system (re-)starts the link.</p>
  </div>
  <div class="paragraph">
  <p>2) if the receiving system gets a transaction with a 0 (zero) in the sequence number field, it SHOULD respond with a general acknowledgment message whose MSA contains a sequence number one greater than the sequence number of the last transaction it accepted in the Expected Sequence Number field. If this value does not exist (as on the first startup of a given link), the MSA SHOULD contain a sequence number of -1, meaning that the receiving system will use the positive, non-zero sequence number of the first transaction it accepts as its initial sequence number (see re-synching the link, item e below).</p>
  </div>
  <div class="paragraph">
  <p>3) the initiating system then sends the transaction indexed by the expected sequence number (if that expected transaction is still on its queue). Otherwise the link is frozen until an operator intervenes.</p>
  </div>
  <div class="paragraph">
  <p>c) normal operation of the link:</p>
  </div>
  <div class="paragraph">
  <p>As it accepts each transaction, the receiving system securely stores the sequence number (which agrees with its expected sequence number), and then acknowledges the message by echoing the sequence number in link:#_MSA-4___Expected Sequence Number  ([MSA-4 Expected Sequence Number].</p>
  </div>
  <div class="paragraph">
  <p>d) error conditions (from point of view of initiating system). These are generated by the receiving system, by its comparison of the sequence number sent out (with the MSH in link:#_MSH-13<em>_Sequence Number  (NM)   00[MSH-13 Sequence Number]) with the expected sequence number (link:#_MSA-4</em>_Expected Sequence Number  ([MSA-4 Expected Sequence Number] received with the MSA).</p>
  </div>
  <div class="paragraph">
  <p>1) expected sequence number is one greater than current value. The previous acknowledgment was lost. That transaction was sent again. Correct by sending next transaction.</p>
  </div>
  <div class="paragraph">
  <p>2) expected sequence number less than current value. Initiating system can try starting again by issuing a transaction with a sequence number of zero; or freeze the link for operator intervention.</p>
  </div>
  <div class="paragraph">
  <p>3) other errors: freeze the link for operator intervention</p>
  </div>
  <div class="paragraph">
  <p>e) forcing resynchronization of sequence numbers across the link. The value of -1 for a sequence number is reserved: it is allowed only when the initiating system is re-synchronizing the link. Thus if the receiving system gets a value of -1 in the sequence number field, it SHOULD return a general acknowledgment message with a -1 in the expected sequence number field. The receiving system then resets its sequence number, using the non-zero positive sequence number of the next transaction it accepts.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  When the initiating system sends a message with a sequence number of 0 or -1 (see b or e above), the segments beyond the MSH need not be present in the message, or, if present, all fields MAY be empty or unpopulated. In terms of the responding system, for these two cases, only a General acknowledgment message is needed.*
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_continuation_messages_and_segments">Continuation messages and segments</h3>
  <div class="paragraph">
  <p>Sometimes, implementation limitations require that large messages or segments be broken into manageable chunks. We use the term "fragmentation" to describe how a logical message is broken into one or more separate HL7 messages. HL7 consciously identifies two situations where this MAY happen.</p>
  </div>
  <div class="paragraph">
  <p>First, a single segment mightbe too large. HL7 uses the "ADD" segment to handle breaking a single segment into several smaller segments.</p>
  </div>
  <div class="paragraph">
  <p>Second, a single HL7 message might be too large. HL7 uses the DSC segment and the continuation protocol to handle message fragmentation.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  HL7 does not define what "too large" means. Acceptable values are subject to site negotiations.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>See chapter 5 for a discussion of the continuation pointer segment and the continuation pointer field, and their use in the continuation of responses to queries and in the continuation of unsolicited update messages.</p>
  </div>
  <div class="sect3">
  <h4 id="_segment_fragmentationcontinuation_using_the_add_segment">Segment fragmentation/continuation using the ADD segment</h4>
  <div class="paragraph">
  <p>Beginning with version 2.4, the ADD segment can be used <span class="underline">within</span> a message to break a long segment into shorter segments within a single HL7 message.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  Unless some explicit agreement exists between systems, a receiving application SHOULD NOT infer semantic meaning from the placement of the ADD segment.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>To break a large segment,</p>
  </div>
  <div class="paragraph">
  <p>a) the segment being continued (call it ANY for this example) is ended at an arbitrary character position and terminated with the standard segment terminator (carriage return).</p>
  </div>
  <div class="paragraph">
  <p>b) the following segment is the ADD segment. All characters after the ADD and field separator ("|") are logically part of the preceding segment. All succeeding consecutive ADD segments contribute characters to the ANY segment until a non ADD segment is found.</p>
  </div>
  <div class="paragraph">
  <p>c) an ADD segment with no field separator takes on special meaning. See Section <a href="#segment-fragmentation-across-messages"><em>2.10.2.3</em></a>, "<a href="#segment-fragmentation-across-messages"><em>Segment fragmentation across messages</em></a>".</p>
  </div>
  <div class="paragraph">
  <p>For example, segment "C" can be fragmented within an HL7 message as follows:</p>
  </div>
  <div class="paragraph">
  <p>A|1</p>
  </div>
  <div class="paragraph">
  <p>B|2</p>
  </div>
  <div class="paragraph">
  <p>C|34</p>
  </div>
  <div class="paragraph">
  <p>ADD|5|678|</p>
  </div>
  <div class="paragraph">
  <p>ADD|90</p>
  </div>
  <div class="paragraph">
  <p>D|1</p>
  </div>
  <div class="paragraph">
  <p>This is logically the same as</p>
  </div>
  <div class="paragraph">
  <p>A|1</p>
  </div>
  <div class="paragraph">
  <p>B|2</p>
  </div>
  <div class="paragraph">
  <p>C|345|678|90</p>
  </div>
  <div class="paragraph">
  <p>D|1</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_segment_fragmentationcontinuation_using_the_dsc_segment">Segment fragmentation/continuation using the DSC segment</h4>
  <div class="paragraph">
  <p>When a message itself must be fragmented and sent as several HL7 messages, the DSC segment is used.</p>
  </div>
  <div class="paragraph">
  <p>a) First, the logical message is broken after an arbitrary segment.</p>
  </div>
  <div class="paragraph">
  <p>b) Next, a DSC segment is sent. The link:#_DSC-1___Continuation Pointer (ST)  [DSC-1 Continuation Pointer] field will contain a unique value that is used to match a subsequent message with this specific value.</p>
  </div>
  <div class="paragraph">
  <p>c) The DSC terminates the first fragment of the logical message.</p>
  </div>
  <div class="paragraph">
  <p>d) A subsequent message will contain in link:#_MSH-14<em>_Continuation Pointer  (ST)[MSH-14 Continuation Pointer], a value that matches the value from DSC-1. (The presence of a value in MSH-14 indicates that the message is a fragment of an earlier message.). Each subsequent message will have its own unique value for link:#_MSH-10</em>_Message Control ID  (ST)  [MSH-10 Message Control ID]. Coordination between link:#_DSC-1<em>_Continuation Pointer (ST)  [DSC-1 Continuation Pointer] and the subsequent message&#8217;s link:#_MSH-14</em>_Continuation Pointer  (ST)[MSH-14 Continuation Pointer] is used to link the fragments in their proper order.</p>
  </div>
  <div class="paragraph">
  <p>e) The logical message is the concatenation of the contents of the first message (which while having no value in MSH-14, did end with DSC, and hence was actually a message fragment), plus all subsequent fragments (as identified by values in MSH-14).</p>
  </div>
  <div class="paragraph">
  <p>f) If enhanced mode acknowledgments are used to request an accept ACK, then the receiver will acknowledge each fragment with an ACK message. Since each fragment has its own Message Control ID, each fragment level accept ACK will use the Message Control ID from the fragment it is acknowledging.</p>
  </div>
  <div class="paragraph">
  <p>g) If enhanced mode acknowledgments are used to request an application level ACK, then the receiver will send an acknowledgment after receiving the final fragment.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The application level ACK SHOULD refer to the message by the Message Control ID of the first fragment.
  </td>
  </tr>
  </table>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The receiver can tell that a given incoming message is a fragment by the presence of the trailing DSC. Subsequent HL7 messages are identified as fragments by the presence of an MSH-14 value. The presence of a DSC in a fragment indicates that more fragments are to follow.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>It is a protocol error to end a message with DSC, and then never send a fragment.</p>
  </div>
  <div class="paragraph">
  <p>For example, a single logical message MAY be fragmented into three HL7 messages:</p>
  </div>
  <div class="paragraph">
  <p>---- Sender HL7 message (incomplete,fragment1)---</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||1001||2.4|123||..</p>
  </div>
  <div class="paragraph">
  <p>A|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>B|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>DSC|W4xy</p>
  </div>
  <div class="paragraph">
  <p>---- Sender HL7 message (fragment 2)---</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||2106||2.4|124|W4xy|</p>
  </div>
  <div class="paragraph">
  <p>C|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>D|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>DSC|V292</p>
  </div>
  <div class="paragraph">
  <p>----- another HL7 message(fragment 3, final)---</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||2401||2.4|125|V292</p>
  </div>
  <div class="paragraph">
  <p>E|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>Such a sequence is logically the same as the single message:</p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|2.4|123||..</p>
  </div>
  <div class="paragraph">
  <p>A|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>B|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>C|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>D|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>E|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>See example in section <strong><em>Error! Reference source not found.</em></strong> for a more elaborate example.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_segment_fragmentation_across_messages">Segment fragmentation across messages</h4>
  <div class="paragraph">
  <p>If the last segment of a fragment itself needs to be broken, then the following idiomatic use of ADD SHALL apply.</p>
  </div>
  <div class="paragraph">
  <p>a) the segment being continued (call it ANY for this example) is ended at an arbitrary character position and terminated with the standard segment terminator (carriage return).</p>
  </div>
  <div class="paragraph">
  <p>b) the following segment is the ADD segment. It will contain no characters other than "ADD". (The lack of characters signals the receiver that ANY will be continued.)</p>
  </div>
  <div class="paragraph">
  <p>c) The second following segment will be the DSC, used as described above in Section <em>2.9.2.1</em>, "<em>Segment fragmentation/continuation using the DSC segment</em>".</p>
  </div>
  <div class="paragraph">
  <p>d) The first segment of the following fragment will be an ADD segment. The characters of this ADD segment are logically part of the ANY segment of the previous fragment.</p>
  </div>
  <div class="paragraph">
  <p>For example</p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|2.4|</p>
  </div>
  <div class="paragraph">
  <p>ANY|12</p>
  </div>
  <div class="paragraph">
  <p>ADD</p>
  </div>
  <div class="paragraph">
  <p>DSC|JR97</p>
  </div>
  <div class="paragraph">
  <p>--------- (fragment 2)</p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|2.4|JR97</p>
  </div>
  <div class="paragraph">
  <p>ADD|345</p>
  </div>
  <div class="paragraph">
  <p>is logically the same as</p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|2.4</p>
  </div>
  <div class="paragraph">
  <p>ANY|12345</p>
  </div>
  <div class="paragraph">
  <p>e) transaction flow for a continued unsolicited message with a continued segment.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 21. First unsolicited message and acknowledgment:</caption>
  <colgroup>
  <col style="width: 29%;">
  <col style="width: 71%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">URD</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ URS ]</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">{DSP}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(last DSP is incomplete)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ADD</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(contains no fields)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">DSC</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(Continuation segment)</p></td>
  </tr>
  </tbody>
  </table>
  <table class="tableblock frame-all grid-all stretch">
  <colgroup>
  <col style="width: 29%;">
  <col style="width: 71%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(General acknowledgment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ \{ ERR } ]</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 22. Second unsolicited message and acknowledgment:</caption>
  <colgroup>
  <col style="width: 29%;">
  <col style="width: 71%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(contains continuation pointer from DSC segment of prior message)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ADD</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(contains remainder of data from continued DSP segment from prior message)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">{DSP}</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 23. <strong>Note</strong>: This second message could itself be continued with a second DSC and (if needed) a second ADD segment prior to it.</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 70%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(General acknowledgment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ \{ SFT } ]</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ \{ ERR } ]</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_hl7_batch_protocol">HL7 batch protocol</h3>
  <div class="paragraph">
  <p>There are instances when it is convenient to transfer a batch of HL7 messages. Common examples would be a batch of financial posting detail transactions (DFT&#8217;s) sent from an ancillary to a financial system. Such a batch could be sent online using a common file transfer protocol, or offline via tape or diskette.</p>
  </div>
  <div class="sect3">
  <h4 id="_hl7_batch_file_structure">HL7 batch file structure</h4>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 24. The structure of an HL7 batch file is given by the following (using the HL7 abstract message syntax)</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 70%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[FHS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(file header segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{ARV}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Access Restrictions</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--- BATCH begin</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[BHS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(batch header segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{ARV}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Access Restrictions</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ [</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--- MESSAGE begin</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(zero or more HL7 messages)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">] }</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--- MESSAGE end</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[BTS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(batch trailer segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--- Batch end</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[FTS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(file trailer segment)</p></td>
  </tr>
  </tbody>
  </table>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  s:
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The sequence numbering protocol has a natural application in batch transfers. See the discussion of batch acknowledgments that follows.</p>
  </div>
  <div class="paragraph">
  <p>Although a batch will usually consist of a single type of message, there is nothing in the definition that restricts a batch to only one message type.</p>
  </div>
  <div class="paragraph">
  <p>The HL7 file and batch header and trailer segments are defined in exactly the same manner as the HL7 message segments. Hence the HL7 message construction rules of Sections <em>2.4.5</em> and <em>2.5</em>, can be used to encode and decode HL7 batch files.</p>
  </div>
  <div class="paragraph">
  <p>There are only two cases in which an HL7 batch file MAY contain zero HL7 messages:</p>
  </div>
  <div class="paragraph">
  <p>a) a batch containing zero HL7 messages MAY be sent to meet a requirement for periodic submission of batches when there are no messages to send.</p>
  </div>
  <div class="paragraph">
  <p>b) a batch containing zero negative acknowledgment messages MAY be sent to indicate that all the HL7 messages contained in the batch being acknowledged are implicitly acknowledged. See Section <em>2.9.3.3</em>, "<em>Acknowledging batches</em>."</p>
  </div>
  <div class="paragraph">
  <p>To better understand, why security labels MAY be applicable to batch files, we provide the following use case:</p>
  </div>
  <div class="paragraph">
  <p>Some HIEs (likely a majority of US HIEs) push ADTs to HIE participants authorized to receive these under HIPAA. Some consider payers to be authorized to receive ADTs under HIPAA (despite the fact that ADTs are for treatment purposes and should likely only be going to providers.)</p>
  </div>
  <div class="paragraph">
  <p>If 1..<strong>of the ADTs included in 1..</strong> BSH within a FSH contains an ADT with security label indicating that this information is not to be disclosed to payer X based on patient right under HIPAA to restrict because the patient paid for services in full out of pocket, then the HIE SHOULD NOT automatically send the entire FSH to the payers it would otherwise send it to,</p>
  </div>
  <div class="paragraph">
  <p>The HIE would need to parse the FSH to find the 1..* BSH with security label = do not disclose to payer X. It could then send any of the other BSH on to payers as usual.</p>
  </div>
  <div class="paragraph">
  <p>It would then parse the 1..* BSH with security label = do not disclose to payer X to find the 1..*MSH with the security label = do not disclose to payer X, and then send those MSH to the payers besides payer X.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_related_segments_and_data_usage">Related segments and data usage</h4>
  <div class="paragraph">
  <p>The following segments relate to the HL7 Batch Protocol:</p>
  </div>
  <div class="paragraph">
  <p>BHS Batch Header (See section <em>2.13.2</em>)</p>
  </div>
  <div class="paragraph">
  <p>BTS Batch Trailer (See section <em>2.13.3</em>)</p>
  </div>
  <div class="paragraph">
  <p>FHS File Header (See section <em>2.13.6</em>)</p>
  </div>
  <div class="paragraph">
  <p>FTS File Trailer (See section <em>2.13.7</em>)</p>
  </div>
  <div class="paragraph">
  <p>The BTS segment contains a field, link:#_BTS-3___Batch Totals  (NM)   00095[BTS-3 Batch Totals], which MAY have one or more totals drawn from fields within the individual messages. The method for computing such totals will be determined on a site or application basis unless explicitly stated in a functional chapter.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_acknowledging_batches">Acknowledging batches</h4>
  <div class="paragraph">
  <p>In general, the utility of sending batches of data is that the data is accepted all at once, with errors processed on an exception basis. However, it is a permissible application of HL7 to acknowledge all messages. Several options for acknowledgment are given and will be chosen on an application basis. In these cases, the sequence numbering protocol can be useful to the applications processing the batch.</p>
  </div>
  <div class="paragraph">
  <p>The options are:</p>
  </div>
  <div class="paragraph">
  <p>a) all messages are acknowledged in the response batch.</p>
  </div>
  <div class="paragraph">
  <p>b) the receiving system prints some form of batch control report, which is then dealt with manually by personnel at the sending system. No acknowledgments are performed by the protocol software.</p>
  </div>
  <div class="paragraph">
  <p>c) an automated acknowledgment batch is created containing acknowledgment messages only for those messages containing errors. In this mode an empty acknowledgment batch MAY be created (i.e., an HL7 batch file without any HL7 acknowledgment messages).</p>
  </div>
  <div class="paragraph">
  <p>In each case where there is a response batch, its format is a batch of individual messages. Each individual message is in the format defined for an online response in the chapters. Consider, for example, a batch that might be constructed to respond to a batch of Detailed Financial Transactions (Chapter 6). The messages in the response batch would consist entirely of ACK messages, since ACK is the response shown in Chapter 6.</p>
  </div>
  <div class="paragraph">
  <p>When batches are retransmitted after the correction of errors, link:#_BHS-12___Reference Batch Control ID[BHS-12 Reference Batch Control ID] SHOULD contain the batch control ID of the original batch.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_batch_message_as_a_query_response">Batch message as a query response</h4>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The QRD and QRF segments were retained for backward compatibility only as of v 2.4. The reader is referred to chapter 5, section 5.4, for the current query/response message structure.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The HL7 query also can be used to query for a batch in the following manner:</p>
  </div>
  <div class="paragraph">
  <p>a) use the B in ResponseModality field of the RCP segment. The query will be acknowledged with a general acknowledgment as in the Deferred Access example above (see chapter 5)</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 25. b) in addition, insert into the batch file the QRD and QRF segments as follows:</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 70%;">
  </colgroup>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[FHS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(file header segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ [BHS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(batch header segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[QPD]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(the QRD and QRF define the</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[RCP]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">query that this batch is a response to)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{ MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(one or more HL7 messages)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;.</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[BTS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(batch trailer segment)</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[FTS]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">(file trailer segment)</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>c) the acknowledgment of a batch is described in this chapter (see Section <em>2.9.3.3</em>, "<em>Acknowledging batches</em>").</p>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_protocol_for_interpreting_repeating_segments_or_segment_groups_in_an_update_message">Protocol for interpreting repeating segments or segment groups in an update Message</h3>
  <div class="paragraph">
  <p>This section describes the protocol for interpreting repeating segments or segment groups in an update message. Common examples of repeating segments are NK1 and OBX shown as [{NK1}] and [{OBX}] in the abstract message syntax. Common examples of segment groups are displayed as \{ORC RXO [{RXC}]} or [\{IN1 [IN2] [{IN3}]}] in the abstract message syntax</p>
  </div>
  <div class="paragraph">
  <p>There are 2 methods of update: the "snapshot" and the "action code/unique identifier" modes. These are defined in sections 2.10.4.1 and 2.10.4.2 below.</p>
  </div>
  <div class="paragraph">
  <p>If a particular repeating segment can be updated by either of these two modes, the parties concerned will determine by agreement among messaging partners whether an interface will use the "snapshot" mode or the "action code/unique identifier" mode.</p>
  </div>
  <div class="paragraph">
  <p>Both the sender and receiver of the data must have predictable rules for how they will process the data in repeating segments or segment groups regardless of which mode is used. This SHOULD be documented in the Conformance Profile. It is critical to know, for instance, if the Sender is the System of Record.</p>
  </div>
  <div class="sect3">
  <h4 id="_hiddentext">hiddentext</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_snapshot_mode_update_definition">Snapshot mode update definition</h4>
  <div class="paragraph">
  <p>For segments that do not contain unique identifiers and action codes (mainly NTE and patient administration segments), the only option is to treat the information in the repeating segments and segment groups as a whole.</p>
  </div>
  <div class="paragraph">
  <p>When an HL7 abstract message syntax includes these repeating units or sets, there is no implicit indication of how they interact with a similar set in a prior or subsequent message. Interpretation is not obvious from the message syntax particularly if the requirement is to update only part of the information previously sent.</p>
  </div>
  <div class="paragraph">
  <p>The existence of a segment, and possibly the lack of existence of a segment, might serve to add, update, replace, or delete information passed in similar segments in prior messages. Special consideration is warranted in the case where multiple instances of a segment exist in a message.</p>
  </div>
  <div class="paragraph">
  <p>In the “snapshot” mode, a group of repeating segments from the incoming message replaces the prior group of repeating segments on the receiving system. This is equivalent to a deletion of the prior group followed by the addition of the new group.</p>
  </div>
  <div class="paragraph">
  <p>To avoid confusion when all of the segments in a repeating group are to be deleted, one must send a single segment with “delete data” indicated for the first field (or all fields) of the segment to indicate that all information related to the segment is to be deleted.  In this scenario, snapshot mode provides for deleting the prior group of repeating segment data on the receiving system.  Otherwise, sending no segment(s) at all without such explicit indication could lead the receiver to assume nothing was changed, thus not sent.  I.e., if no segment is sent, this equates to "no information." No information SHOULD NOT signal the receiver to take an action, i.e. no action SHOULD be taken on any of the data related to the prior group of repeating segments.</p>
  </div>
  <div class="paragraph">
  <p>Since messages MAY contain multiple, possibly nested, groups, it is critically important to understand the level at which group(s) are subject to snapshot mode, especially the delete functionality outlined above. For example, a results message MAY include results for multiple patients, or a charge batch MAY include charges for multiple patients. Whether snapshot, and especially delete, applies to all the patients in the entire message, all the order-observations within one patient, or all the observations within one order-observation group must be agreed to by the trading partners, or otherwise specified in a conformance profile and/or the section-specific chapters of the HL7 Standard.</p>
  </div>
  <div class="paragraph">
  <p>To support assertions made in some chapters, e.g., chapter 6, and common practice at implementation sites, as of v2.6, the signal methods have been extended. By agreement among messaging partners or Conformance Profile, a sender might opt to signal deletion of data in the following manner:</p>
  </div>
  <div class="paragraph">
  <p>Transmit the delete indicator only:</p>
  </div>
  <div class="ulist">
  <ul>
  <li>
  <p>in the key identifier field if the segment has an explicit one – all other fields have no data</p>
  </li>
  <li>
  <p>in the first field of the segment to indicate that all are to be deleted</p>
  </li>
  <li>
  <p>in any combination of fields that the Sender customarily sends to the recipient - all other fields have no data</p>
  </li>
  <li>
  <p>in all required fields all – all other fields have no data</p>
  </li>
  </ul>
  </div>
  <div class="paragraph">
  <p>This obviates the need for the Sender to populate fields ordinarily not sent and not expected by the receiver.</p>
  </div>
  <div class="sect4">
  <h5 id="_snapshot_mode_and_repeating_segments_example">Snapshot Mode and Repeating Segments - Example</h5>
  <div class="exampleblock">
  <div class="content">
  A: if a patient record indicated a 2 sisters and a brother as next of kin, this would be represented as follows in the add person/patient information message:
  </div>
  </div>
  <div class="paragraph">
  <p>MSH||||||||ADT<sup>A28</sup>ADT_A05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>NK1|1|Nuclear<sup>Nancy</sup>D|SIS<sup>Sister</sup>HL70063|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>NK1|2|Nuclear<sup>Nelda</sup>W|SIS<sup>Sister</sup>HL70063|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>NK1|3|Nuclear<sup>Neville</sup>S|BRO<sup>Brother</sup>HL70063|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>If, subsequently, the one of the sisters was delisted as next of kin, it would be necessary to send both the remaining "brother" and "sister" records in order to form a complete replacement set in an update person information message:</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||ADT<sup>A31</sup>ADT_A05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>NK1|1|Nuclear<sup>Nancy</sup>D|SIS<sup>Sister</sup>HL70063|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>NK1|2|Nuclear<sup>Neville</sup>S|BRO<sup>Brother</sup>HL70063|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>If all next of kin were to be subsequently delisted, an update message with a single delete indicator populated segment would instruct the receiving system to delete information represented by any prior set:</p>
  </div>
  <div class="paragraph">
  <p>MSH||||||||ADT<sup>A31</sup>ADT_A05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>NK1|""|""|""|""|&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>Alternatively, as of v2.6, the deletion could be signaled by sending a delete indicatorin the first field of the NK1 segment. This is its only required field.</p>
  </div>
  <div class="paragraph">
  <p>MSH||||||||ADT<sup>A31</sup>ADT_A05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>NK1|""|&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  </div>
  <div class="sect4">
  <h5 id="_snapshot_mode_and_repeating_segment_groups">Snapshot Mode and Repeating Segment Groups</h5>
  <div class="paragraph">
  <p>Treatment of the repeating segment group is analogous to the handling of the repeating segment described above. To indicate deletion of all of the information in a repeating segment group, it is only necessary to delete the anchoring segment of the segment group. This is accomplished just as described above for deleting a repeating segment. This pertains to segments governed by snapshot mode, not action code.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  An account is created for Adam Everyman. He is insured under plan ID A357 with an insurance company known to both systems as BCMD, with a company ID of 1234. He is also covered by his wife&#8217;s insurance under plan ID A789 with an insurance company known to both systems as VGMC, with a company ID of 6789.
  </div>
  </div>
  <div class="paragraph">
  <p>MSH||||||||BAR<sup>P01</sup>BAR_P01|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|</p>
  </div>
  <div class="paragraph">
  <p>PID|</p>
  </div>
  <div class="paragraph">
  <p>IN1|1|A357|1234|BCMD</p>
  </div>
  <div class="paragraph">
  <p>IN2|</p>
  </div>
  <div class="paragraph">
  <p>IN3|</p>
  </div>
  <div class="paragraph">
  <p>IN1|2|A789|6789|VGMC</p>
  </div>
  <div class="paragraph">
  <p>IN2|</p>
  </div>
  <div class="paragraph">
  <p>IN3|</p>
  </div>
  <div class="paragraph">
  <p>Subsequently it is learned that his wife has changed insurance plans. Her new plan is now C45. The insurance company and company ID have remained the same. A BAR^P05 might be sent.</p>
  </div>
  <div class="paragraph">
  <p>MSH||||||||BAR<sup>P05</sup>BAR_P05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|</p>
  </div>
  <div class="paragraph">
  <p>PID|</p>
  </div>
  <div class="paragraph">
  <p>IN1|1|A357|1234|BCMD</p>
  </div>
  <div class="paragraph">
  <p>IN2|</p>
  </div>
  <div class="paragraph">
  <p>IN3|</p>
  </div>
  <div class="paragraph">
  <p>IN1|2|C45|6789|VGMC</p>
  </div>
  <div class="paragraph">
  <p>IN2|</p>
  </div>
  <div class="paragraph">
  <p>IN3|</p>
  </div>
  <div class="paragraph">
  <p>It is later discovered that the patient is not covered by either plan and now has no insurance at all. A BAR^P05 is again sent. In accordance with chapter 6, this can be signaled by showing delete indicator in the plan field.</p>
  </div>
  <div class="paragraph">
  <p>MSH||||||||BAR<sup>P05</sup>BAR_P05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|</p>
  </div>
  <div class="paragraph">
  <p>PID|</p>
  </div>
  <div class="paragraph">
  <p>IN1|""|""</p>
  </div>
  <div class="paragraph">
  <p>If, on the other hand, the patient still had his coverage, and only the wife&#8217;s insurance had been dropped, a fully populated IN1 segment group would be transmitted. The presence of only one IN1 in a subsequent message conveys the "full group replacement" notion. The BAR^P05 would be transmitted and would be interpreted to mean "retain plan A357; delete and other plans":</p>
  </div>
  <div class="paragraph">
  <p>MSH||||||||BAR<sup>P05</sup>BAR_P05|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|</p>
  </div>
  <div class="paragraph">
  <p>PID|</p>
  </div>
  <div class="paragraph">
  <p>IN1|1|A357|1234|BCMD</p>
  </div>
  <div class="paragraph">
  <p>IN2|</p>
  </div>
  <div class="paragraph">
  <p>IN3|</p>
  </div>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_action_codeunique_identifier_mode_update_definition">Action code/unique identifier mode update definition</h4>
  <div class="paragraph">
  <p>In the "action code/unique identifier" mode (action code mode), each member of a segment or segment group can be acted upon independently of the other members. Thus, it is possible to delete or update a member of the set without including the other members of the set. The choice of delete/update/insert is determined by the action code (or an equivalent such as result status in an ORU Observation Report message). Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70206"><em>HL7 Table 0206 - Segment Action Code</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  <div class="paragraph">
  <p>The <em>unique identifier</em> unambiguously identifies one of multiple repetitions of the repeating segment or segment group in a way that does not change over time. It is not dependent on any particular message identifier level (MSH) fields; it functions across messages, not just within a message. For a single segment repetition, the <em>unique identifier</em> MAY be an explicit field (e.g., IAM-7 Allergy Unique Identifier) or a combination of fields (IAM suggests IAM-3 Allergen Identifier in the context of the particular patient). For a repeating segment group, an identifier in the anchoring segment would identify the repeating set. For MFN messages, MFI-1 Master File Identifier and MFE-4 Primary Key Value identify the particular table and record.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  1: If a patient is allergic to penicillin and shellfish, the following message would be sent showing an Action code of "A(dd) in IAM-6:
  </div>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||ADT<sup>A60</sup>ADT_A60|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>IAM|1||peni|||A&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>IAM|2||shell||A&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>Subsequently, if it is learned that the patient is not allergic to shellfish, the following message would be sent showing an Action code of "D(elete) in IAM-6:</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||ADT<sup>A60</sup>ADT_A60|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>IAM|1||shell||D&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>Some messages, Orders and Observations, in particular, do not use table 0206. Order control codes are used to unambiguously specify the action to be taken.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  2: if a set of orders had been sent as
  </div>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||OML<sup>O21</sup>OML_O21|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>ORC|NW|987654^CIS|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>ORC|NW|876543^CIS|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>ORC|NW|765432^CIS|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>and subsequently order 876543 was cancelled, the following message would target that specific segment instance without affecting the other orders. ORC-1 contains order control code "CA" for cancel. ORC-2 identifies the specific order number.</p>
  </div>
  <div class="paragraph">
  <p>MSH|||||||||OML<sup>O21</sup> OML_O21|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|</p>
  </div>
  <div class="paragraph">
  <p>ORC|CA|876543^CIS|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  3: Add staff person to Provider master:
  </div>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|HL7REG|UH|HL7LAB|CH|200102280700||MFN</sup>M02^MFN_M02|MSGID002|P|2.7|||AL|NE</p>
  </div>
  <div class="paragraph">
  <p>MFI|PRA^Practitioner Master File^HL70175||UPD|||AL</p>
  </div>
  <div class="paragraph">
  <p>MFE|MAD|U2246|200102280700|PMF98123789182^^PLW|CWE</p>
  </div>
  <div class="paragraph">
  <p>STF|PMF98123789182<sup>^PLW|U2246</sup>^^PLW |SEVEN<sup>HENRY</sup>L<sup>JR</sup>DR<sup>M.D.|P|M|19511004|A|</sup>ICU|^MED|(555)555-1002X345CO~(955)555-1002CH(206)689-1345X789CB|1002 Healthcare Drive^SUITE 227<sup>AnnArbor</sup>MI<sup>48104</sup>US~1012 Healthcare Drive^^AnnArbor, MI<sup>48104</sup>O |19890125^GHH&amp;Good Health Hospital&amp;L01||PMF88123453334|<a href="mailto:74160.2326@COMPUSERV.COM">74160.2326@COMPUSERV.COM</a>|B</p>
  </div>
  <div class="paragraph">
  <p>The birth date was discovered to be in error. An MFN^M02 message is sent with the MFE-1 having a value of MUP for Update Record for master File. The corrected birth date (19521004) appears in STF-6:</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|HL7REG|UH|HL7LAB|CH|200102280700||MFN</sup>M02^MFN_M02|MSGID002|P|2.7|||AL|NE</p>
  </div>
  <div class="paragraph">
  <p>MFI|PRA^Practitioner Master File^HL70175||UPD|||AL</p>
  </div>
  <div class="paragraph">
  <p>MFE|MUP|U2246|200102280700|PMF98123789182^^PLW|CWE</p>
  </div>
  <div class="paragraph">
  <p>STF|PMF98123789182<sup>^PLW|U2246</sup>^^PLW |SEVEN<sup>HENRY</sup>L<sup>JR</sup>DR<sup>M.D.|P|M|19521004|A|</sup>ICU|^MED|(555)555-1002X345CO~(955)555-1002CH(206)689-1345X789CB|1002 Healthcare Drive^SUITE 227<sup>AnnArbor</sup>MI<sup>48104</sup>US~1012 Healthcare Drive^^AnnArbor, MI<sup>48104</sup>O |19890125^GHH&amp;Good Health Hospital&amp;L01||PMF88123453334|<a href="mailto:74160.2326@COMPUSERV.COM">74160.2326@COMPUSERV.COM</a>|B</p>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_protocol_for_interpreting_repeating_fields_in_an_update_message">Protocol for interpreting repeating fields in an update message</h3>
  <div class="paragraph">
  <p>With repeating fields, the segment action codes are not relevant. Action codes cannot be applied to individual field repetitions, because they cannot be uniquely identified. Therefore, they must all be there, i.e., send a full list for each transaction. If the intent is to delete an element, it is left off the list. This is analogous to the snapshot mode for repeating segments and segment groups. If the intent is to delete the whole list, the field is transmitted once with a delete indicator in the first component. In effect, the Sender must make a statement about what action the receiver is expected to take: omitting, or not populating, the field is not a clear signal according to field state definition as described in section 2.5.3.</p>
  </div>
  <div class="paragraph">
  <p>At the same time, it is not incorrect to be precise about specific information that is to be deleted if the data type supports this capability. Note, however, that data types without components, e.g., ID or ST do not support this capability. There is no way to tie the delete indicator to an actual element instance in the persistent data store. See the example below.</p>
  </div>
  <div class="paragraph">
  <p>Special consideration is warranted when implementing multiple interfaces. While the same processing rules (snapshot or update) can be applied to multiple systems and interfaces, desynchronization can occur if any one system is receiving similar information from multiple sources. Business rules and processes need to be considered in these cases to determine if there is a single authoritative source for the information (a "System of Record"), or if other business logic exists to resolve the possibility that information from the two (or more) sources are not in agreement.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  Repeating field of data type ID: A patient is added to the Master Patient Index. The patient has two specific living conditions: "spouse dependent" and "medical supervision required". This is transmitted as:
  </div>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;||||||||ADT</sup>A28^ADT_A05|1|P|2.7&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|||1234567<sup>^</sup>^MRN| &lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PD1|S~M|</p>
  </div>
  <div class="paragraph">
  <p>Subsequently, the "medical supervision required" living condition is dropped.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;||||||||ADT</sup>A31^ADT_A31|1|P|2.7&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|||1234567<sup>^</sup>^MRN|&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PD1|S||||||||||||||||||||||</p>
  </div>
  <div class="paragraph">
  <p>The data type for PD1-1 is a data types without components. There is no way to tie the delete indicator to an actual element instance in the persistent data store. Therefore the following is ambiguous and not good practice.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;||||||||ADT</sup>A31^ADT_A31|1|P|2.7&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>EVN|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PID|||1234567<sup>^</sup>^MRN|&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PV1|&#8230;&#8203;&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>PD1|S~""||||||||||||||||||||||</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_local_extension">Local Extension</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The following section specifies where local extensions to a message and its constituent parts are allowed, where they are not, and where they are ill-advised. Inter-version compatibility rules must be followed plus there are certain restrictions and prohibitions outlined in the sections that follow. In general, basic structures SHOULD NOT be altered.</p>
  </div>
  <div class="paragraph">
  <p>The reader is advised to review the Conformance mechanism defined in section 2B<em>,</em> "Conformance Using Message Profiles" before applying local extensions. Using the conformance mechanismighteliminate the need for local extension.</p>
  </div>
  <div class="sect2">
  <h3 id="_messages_2">Messages</h3>
  <div class="paragraph">
  <p>Messages MAY be locally extended as follows:</p>
  </div>
  <div class="paragraph">
  <p>a) Users MAY develop local Z messages to cover areas not already covered by existing HL7 messages. These SHOULD be composed of HL7 segments where possible.</p>
  </div>
  <div class="paragraph">
  <p>b) A local Z message MAY consist entirely of Z segments except that it SHALL begin with a MSH segment.</p>
  </div>
  <div class="paragraph">
  <p>c) A local Z Acknowledgment message SHALL begin with an MSH segment followed by an MSA segment, an optional SFT segment and a conditional ERR segment.</p>
  </div>
  <div class="paragraph">
  <p>d) Users MAY develop Z segments and add them to Z messages.</p>
  </div>
  <div class="paragraph">
  <p>e) Users MAY develop Z segments and add them to HL7 messages. The trigger event MAY remain the same if the intent of the message has remained unchanged.</p>
  </div>
  <div class="paragraph">
  <p>f) The practice of adding additional HL7 segments, like NTE, to existing HL7 messages locally is ill-advised. HL7 MAY move or change the segment in a future release; this will render the message unparsible.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_trigger_events_2">Trigger events</h3>
  <div class="paragraph">
  <p>Users MAY develop local Z trigger events for messages.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_segment_groups">Segment groups</h3>
  <div class="paragraph">
  <p>a) The practice of turning a single segment or segments into a segment group locally <strong>SHALL NOT be</strong> allowed within an HL7 event. It will have a negative impact on XML and any component-based encoding schemes. Note that HL7, on other hand, can do this.</p>
  </div>
  <div class="paragraph">
  <p>b) A segment group MAY NOT be ungrouped locally.</p>
  </div>
  <div class="paragraph">
  <p>For example, if there is an HL7 group as follows:</p>
  </div>
  <div class="paragraph">
  <p>\{</p>
  </div>
  <div class="paragraph">
  <p>ABC</p>
  </div>
  <div class="paragraph">
  <p>[DEF</p>
  </div>
  <div class="paragraph">
  <p>[GHI]]</p>
  </div>
  <div class="paragraph">
  <p>}</p>
  </div>
  <div class="paragraph">
  <p>one cannot change it in a local implementation to be as follows:</p>
  </div>
  <div class="paragraph">
  <p>\{[ABC]}</p>
  </div>
  <div class="paragraph">
  <p>[DEF]</p>
  </div>
  <div class="paragraph">
  <p>[GHI]</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  2:
  </div>
  </div>
  <div class="paragraph">
  <p>If the original definition was:</p>
  </div>
  <div class="paragraph">
  <p>GROUP1 ::= ABC, GROUP2?</p>
  </div>
  <div class="paragraph">
  <p>GROUP2 ::= DEF, GHI?</p>
  </div>
  <div class="paragraph">
  <p>and someone wished to constrain the segments in GROUP2 to be mandatory</p>
  </div>
  <div class="paragraph">
  <p>(i.e., the HL7 grammar would look like:</p>
  </div>
  <div class="paragraph">
  <p>\{[</p>
  </div>
  <div class="paragraph">
  <p>ABC</p>
  </div>
  <div class="paragraph">
  <p>DEF</p>
  </div>
  <div class="paragraph">
  <p>[GHI]</p>
  </div>
  <div class="paragraph">
  <p>]}</p>
  </div>
  <div class="paragraph">
  <p>Their message instance would need to still look like:</p>
  </div>
  <div class="paragraph">
  <p>&lt;GROUP1&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;ABC/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;GROUP2&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;DEF/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;GHI/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;/GROUP2&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;/GROUP1&gt;</p>
  </div>
  <div class="paragraph">
  <p>It would be an error if they instead sent it as:</p>
  </div>
  <div class="paragraph">
  <p>&lt;GROUP1&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;ABC/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;DEF/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;GHI/&gt;</p>
  </div>
  <div class="paragraph">
  <p>&lt;/GROUP1&gt;</p>
  </div>
  <div class="paragraph">
  <p>c) A segment group MAY repeat locally. The 1<sup>st</sup> repetition needs to mean what it does in HL7</p>
  </div>
  <div class="paragraph">
  <p>d) The practice of incorporating a Z segment into a segment group locally <strong>is</strong> allowed.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_segments">Segments</h3>
  <div class="sect3">
  <h4 id="_local_extension_rules_for_segments">Local extension rules for segments</h4>
  <div class="paragraph">
  <p>Users SHALL NOT modify an existing segment, except as specified in section <em>2.7.2</em>, "<em>Changing messages or message constituents</em>".</p>
  </div>
  <div class="paragraph">
  <p>Locally defined fields MAY be defined for use in locally defined segments, although HL7 defined fields are a better choice when available. The practice of extending an HL7 segment with locally defined fields, while not prohibited, is ill-advised.</p>
  </div>
  <div class="paragraph">
  <p>HL7 also recognizes that sites MAY have locally defined fields where the users believe the enhancement might be of interest to the HL7 community as a whole and are moving forward with a proposal to HL7.</p>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_caveats_for_locally_extending_segments">Caveats for locally extending segments</h4>
  <div class="paragraph">
  <p>Locally extending an HL7 segment with locally defined fields will likely cause conformance problems with the next release of the HL7 standard. There are, however, certain circumstances where HL7 has, itself, directed the membership to add Z fields as an interim measure between versions to accommodate regulatory agency requirements. These are fields that HL7 has reserved for official introduction in the next release.</p>
  </div>
  <div class="paragraph">
  <p>If the local site intends to add a proposed field early, there is a risk that it might collide with another field when HL7 officially approves or rejects the proposed additions. Some sites have employed the practice of assigning a high sequence number locally, i.e., leaving a gap between the last official HL7 field and the proposed new field. The user–defined fields SHOULD be deleted or deprecated when HL7 officially approves or rejects the proposed additions so that the fields do not collide. It must be understood that the local implementation will have to adjust if a collision occurs and they want to conform.</p>
  </div>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_data_types">Data types</h3>
  <div class="paragraph">
  <p>The following rules apply for locally extending data types:</p>
  </div>
  <div class="paragraph">
  <p>a) Locally defined data types MAY be defined for use in locally defined segment fields, although HL7 defined data types are a better choice when available.</p>
  </div>
  <div class="paragraph">
  <p>b) Locally redefining existing data type components, e.g., changing a component from NM to ST, is prohibited.</p>
  </div>
  <div class="paragraph">
  <p>c) Data types MAY be locally extended by adding new components at the end. This action creates a Z data type.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The practice of extending an HL7 data type with locally defined components is particularly ill-advised and might cause conformance problems with the next release of the HL7 standard.
  </td>
  </tr>
  </table>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_tables">Tables</h3>
  <div class="paragraph">
  <p>Rules for locally extending tables are the same as discussed in section <em>2.4.3.8</em>, "<em>Table</em>":</p>
  </div>
  <div class="paragraph">
  <p>a) Users MAY redefine suggested values in User-defined tables.</p>
  </div>
  <div class="paragraph">
  <p>b) Local tables MAY be defined for Z fields.</p>
  </div>
  <div class="paragraph">
  <p>c) Local tables MAY be assigned to HL7 fields with data type CWE.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_fields_2">Fields</h3>
  <div class="paragraph">
  <p>Fields MAY be extended locally by the extension of data-types. See section 2.10.5, Data Types.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_representation">Message representation</h3>
  <div class="paragraph">
  <p>For each trigger event the messages that are exchanged when the trigger event occurs are defined using the HL7 abstract message syntax as follows:</p>
  </div>
  <div class="paragraph">
  <p>Each message is defined in special notation that lists the segment IDs in the order they would appear in the message. Braces, \{ . . . }, indicate one or more repetitions of the enclosed group of segments. Of course, the group MAY contain only a single segment. Brackets, [ . . . ], show that the enclosed group of segments is optional. If a group of segments is optional and MAY repeat it SHALL be enclosed in brackets and braces, [\{&#8230;&#8203;}].</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  [\{&#8230;&#8203;}] and \{[&#8230;&#8203;]} are equivalent.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>Whenever braces or brackets enclose more than one segment ID a special stylistic convention is used to help the reader understand the hierarchy of repetition. For example, the first segment ID appears on the same line as the brace, two columns to the right. The subsequent segment IDs appear under the first. The closing brace appears on a line of its own in the same column as the opening brace. This convention is an optional convenience to the user. If there is conflict between its use and the braces that appear in a message schematic, the braces define the actual grouping of segments that is permitted.</p>
  </div>
  <div class="paragraph">
  <p>A choice of one segment from a group of segments is indicated by using angle brackets to delimit the group and vertical bar delimiters between the several segments.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  The following example allows a choice of segments :
  </div>
  </div>
  <div class="paragraph">
  <p>&lt;ABC | DEF | GHI | JKL &gt;</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  The following example allows a choice of segments and/or segment groups. (see Figure 2-5 Hypothetical schematic message)
  </div>
  </div>
  <div class="paragraph">
  <p>The first choice is a repeating group consisting of an ABC segment followed by optionally repeating NTE segments.</p>
  </div>
  <div class="paragraph">
  <p>The second choice is the DEF segment.</p>
  </div>
  <div class="paragraph">
  <p>The third choice is a group with a required GHI segment followed by an optionally repeating group containing a PRT segment followed by an optionally repeating NTE segment.</p>
  </div>
  <div class="paragraph">
  <p>&lt;\{ABC [{NTE}] } |DEF | GHI [\{PRT [{NTE}] }] &gt;</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_chapter_formats_for_defining_hl7_messages">Chapter Formats For Defining HL7 Messages</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>Subsequent chapters of this document describe messages that are exchanged among applications in functionally-specific situations. Each chapter is organized as follows:</p>
  </div>
  <div class="paragraph">
  <p>a) purpose. This is an overview describing the purpose of the chapter, general information and concepts.</p>
  </div>
  <div class="paragraph">
  <p>b) trigger events and messages. There is a list of the trigger events.</p>
  </div>
  <div class="paragraph">
  <p>c) message segments. The segments defined in a chapter are then listed in a functional order designed to maximize conceptual clarity.</p>
  </div>
  <div class="paragraph">
  <p>d) examples. Complete messages are included.</p>
  </div>
  <div class="paragraph">
  <p>e) implementation considerations. Special supplementary information is presented here. This includes issues that must be addressed in planning an implementation.</p>
  </div>
  <div class="paragraph">
  <p>f) outstanding issues. Issues still under consideration or requiring consideration are listed here.</p>
  </div>
  <div class="sect2">
  <h3 id="_hl7_abstract_message_syntax_example">HL7 abstract message syntax example</h3>
  <div class="paragraph">
  <p>Consider the hypothetical triggering event <strong>a widget report is requested</strong>. It might be served by the Widget Request (WRQ) and Widget Report (WRP) messages. These would be defined in the Widget chapter (say Chapter XX). The Widget Request message might consist of the following segments: Message Header (MSH), Software Segment (SFT), User Authentication Credentials (UAC), and Widget ID (WID). The Widget Report message might consist of the following segments: Message Header (MSH), Software Segment (SFT), Message acknowledgment (MSA), Error Segment (ERR) and one or more Widget Description (WDN) Segments each of which is followed by a single Widget Portion segment (WPN) followed by zero or more Widget Portion Detail (WPD) segments. The Widget group ends with the optional Inclusion group, which allows a choice of segments/groups.</p>
  </div>
  <div class="paragraph">
  <p>The ADD and DSC segments follow special rules or protocol as defined in section 2.10.2. They are not represented in the message grammar in the domain chapters as their presence is context sensitive.</p>
  </div>
  <div class="paragraph">
  <p>The schematic form for this hypothetical exchange of messages is shown in Figure 2-5:</p>
  </div>
  <div class="paragraph">
  <p>Figure 2-5. Hypothetical schematic message</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 26. Trigger Event WRQ<sup>Z01</sup>WRQ_Z01: WIDGET REPORT IS REQUESTED</caption>
  <colgroup>
  <col style="width: 29%;">
  <col style="width: 36%;">
  <col style="width: 13%;">
  <col style="width: 22%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">Segments</th>
  <th class="tableblock halign-left valign-top">Desription</th>
  <th class="tableblock halign-left valign-top">Status</th>
  <th class="tableblock halign-left valign-top">Chapter</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MSH">MSH</a></p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Message Header</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{SFT}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Software Segment</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[UAC]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">User Authentication Credential</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WID</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget ID</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>The WID, WDN, WPN, and WPD segments would be defined by the widget committee in the widget chapter, as designated by the Arabic numeral XX in the right column. The MSH and MSA segments, although included in the widget messages, are defined in another chapter. They are incorporated by reference into the widget chapter by the chapter number XX.</p>
  </div>
  <div class="paragraph">
  <p>On the other hand, the widget committee might decide that the WPN and WPD segments SHALL appear in pairs, but the pairs are optional and can repeat. Then the schematic for the WRP message would be as shown in Figure 2-6.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 27. Figure 2-6. WPN and WPD segments in pairs WRQ<sup>Z02</sup>WRQ_Z03</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 37%;">
  <col style="width: 12%;">
  <col style="width: 21%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">WRF</th>
  <th class="tableblock halign-left valign-top">Widget Report</th>
  <th class="tableblock halign-left valign-top">Status</th>
  <th class="tableblock halign-left valign-top">Chapter</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MSH">MSH</a></p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Message Header</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{SFT}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Software Segment</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[UAC]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">User Authentication Credential</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MSA">MSA</a></p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Message Acknowledgment</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{ERR}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Error Segment</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--Widget begin</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WDN</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Description</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[ \{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---WidgetDetailA begin</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WPN</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Portion</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WPD</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Portion Detail</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">} ]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---WidgetDetailA end</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---Widget end</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  <div class="paragraph">
  <p>If the widget committee determined that at least one pair of WPN and WPD segments must follow a WDN, then the notation would be as shown in Figure 2-7.</p>
  </div>
  <table class="tableblock frame-all grid-all" style="width: 99%;">
  <caption class="title">Table 28. Figure 2-7. At least one pair of WPN and WPD WRQ<sup>Z02</sup>WRQ_Z04</caption>
  <colgroup>
  <col style="width: 30%;">
  <col style="width: 36%;">
  <col style="width: 13%;">
  <col style="width: 21%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">WRP</th>
  <th class="tableblock halign-left valign-top">Widget Report</th>
  <th class="tableblock halign-left valign-top">Status</th>
  <th class="tableblock halign-left valign-top">Chapter</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MSH">MSH</a></p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Message Header</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{SFT}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Software Segment</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[UAC]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">User Authentication Credential</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MSA">MSA</a></p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Message Acknowledgment</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">[{ERR}]</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Error Segment</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">--Widget begin</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WDN</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Description</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---WidgetDetailB begin</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WPN</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Portion</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WPD</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Widget Portion Detail</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">XX</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---WidgetDetailB begin</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">}</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">---Widget end</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  </div>
  <div class="sect2">
  <h3 id="_hl7_acknowledgment_choreography_example">HL7 Acknowledgment Choreography Example</h3>
  <div class="paragraph">
  <p>Using the example messages in Figure 2-5. Hypothetical schematic message for the WRQ/WRP message pair:</p>
  </div>
  <div class="paragraph">
  <p>o When MSH-15 is blank and MSH-16 is blank an original mode acknowledgment SHALL be returned on the same communication channel.</p>
  </div>
  <div class="paragraph">
  <p>o When MSH-15 is AL (Always) and MSH-16 is NE (Never) an immediate ack is always returned. When MSH-15 is NE, and MSH-16 is AL, the receiver is expected to only return an WRP application acknowledgment on a separate communication channel. See Section 2.8.3.2</p>
  </div>
  <table class="tableblock frame-all grid-all" style="width: 99%;">
  <caption class="title">Table 29. o When MSH-15 is AL, and MSH-16 is AL, the receiver is expected to return both the immediate ACK as well as the WRP application ack. The immediate ACK will return on the current channel, and the application acknowledgment on a separate communication channel. See Section 2.8.3.2</caption>
  <colgroup>
  <col style="width: 15.8415%;">
  <col style="width: 23.7623%;">
  <col style="width: 14.8514%;">
  <col style="width: 22.7722%;">
  <col style="width: 21.7821%;">
  <col style="width: 0.9905%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">Example of Acknowledgment Choreography:</th>
  <th class="tableblock halign-left valign-top"></th>
  <th class="tableblock halign-left valign-top"></th>
  <th class="tableblock halign-left valign-top"></th>
  <th class="tableblock halign-left valign-top"></th>
  <th class="tableblock halign-left valign-top"></th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WRQ<sup>Z01</sup>WRQ_Z01/WRP<sup>Z02</sup>WRP_Z02</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field name</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field value: Original Mode</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Field Value: Enhanced Mode</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-15</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">BLANK</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">AL(Always)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NE(Never)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">AL(Always)</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH-16</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">BLANK</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NE(Never)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">AL(Always)</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">AL(Always)</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Immediate Ack</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ACK^Z01</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ACK^Z01</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Application Ack</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WRP<sup>Z02</sup>WRP_Z02</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WRP<sup>Z02</sup>WRP_Z02</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">WRP<sup>Z02</sup>WRP_Z02</p></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  </tbody>
  </table>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_acknowledgment_messages">Acknowledgment Messages</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>Acknowledgment messages MAY be defined on an application basis. However the simple general acknowledgment message (ACK) SHALL be used where the application does not define a special message (application level acknowledgment) and in other cases as described in Section <em>2.8</em>, "<em>Message Processing Rules</em>".</p>
  </div>
  <div class="sect2">
  <h3 id="_ack_general_acknowledgment_message">ACK - general acknowledgment message</h3>
  <div class="paragraph">
  <p>The simple general acknowledgment (ACK) can be used where the application does not define a special application level acknowledgment message or where there has been an error that precludes application processing. It is also used for accept level acknowledgments. The details are described in Section <em>2.8</em>, "<em>Message Processing Rules</em>".</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  For the general acknowledgment (ACK) message, the value of MSH-9-2-Trigger event is equal to the value of MSH-9-2-Trigger event in the message being acknowledged. The value of MSH-9-3-Message structure for the general acknowledgment message is always ACK.
  </td>
  </tr>
  </table>
  </div>
  <div class="sect3">
  <h4 id="_acknowledgment_choreography_2">Acknowledgment Choreography</h4>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  In general, there is no purpose for a receiver to acknowledge an Immediate Acknowledgment message while at times it is appropriate to acknowledge an Application Acknowledgment.  Site specific profiles MAY require this based on the use case.
  </td>
  </tr>
  </table>
  </div>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_message_control_segments">Message Control Segments</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The following segments are necessary to support the functionality described in this chapter.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The HL7 message construction rules define the standard HL7 encoding rules, creating variable length delimited messages from the segments defined below. Although only one set of encoding rules is defined as a standard in HL7 Version 2.3, other encoding rules are possible (but since they are non-standard, they MAY only used by a site-specific agreement).
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>The segments in this section are listed in alphabetical order. The following chart shows a summary of the segments listed by category.</p>
  </div>
  <table class="tableblock frame-all grid-all stretch">
  <caption class="title">Table 30. Figure 2-8. HL7 message segments</caption>
  <colgroup>
  <col style="width: 26%;">
  <col style="width: 38%;">
  <col style="width: 36%;">
  </colgroup>
  <thead>
  <tr>
  <th class="tableblock halign-left valign-top">Segment Category</th>
  <th class="tableblock halign-left valign-top">Segment Name</th>
  <th class="tableblock halign-left valign-top">HL7 Section Reference</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">Control</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ADD</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.1</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">BHS</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.2</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">BTS</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.3</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">DSC</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.4</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">ERR</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.5</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">FHS</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.6</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">FTS</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.7</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSA</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.8</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">MSH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.9</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"><p class="tableblock">General Purpose</p></td>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">NTE</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.10</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">OVR</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.10.5</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SFT</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.12</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SGH</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.13</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">SGT</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">2.13.14</p></td>
  </tr>
  <tr>
  <td class="tableblock halign-left valign-top"></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">UAC</p></td>
  <td class="tableblock halign-left valign-top"><p class="tableblock">link:#<em>UAC</em>-_User_Authentication Credentia[2.13.15]</p></td>
  </tr>
  </tbody>
  </table>
  <div class="sect3">
  <h4 id="_add_field_definition">ADD field definition</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_bhs_field_definitions">BHS field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_bts_field_definitions">BTS field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_dsc_field_definitions">DSC field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_err_field_definition">ERR field definition</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_fhs_field_definitions">FHS field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_fts_field_definitions">FTS field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_msa_field_definitions">MSA field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_msh_field_definitions">MSH field definitions</h4>
  <div class="sect4">
  <h5 id="_alphabetic_languages_other_than_english">Alphabetic Languages Other Than English</h5>
  <div class="paragraph">
  <p>The first occurrence of link:#_MSH-18___Character Set   (ID)   006[MSH-18 Character Set] MAY reference a character set other than 7-bit ASCII. Western alphabetic languages other than English are accommodated by the ISO 8859 series of character encodings. For example, if MSH-18 Character Set is valued <strong>8859/1</strong>, the ISO character set commonly known as "8-bit ASCII" is in use in the message. This includes all values from decimal 0 through decimal 127 (hex 00 through hex 7F), plus an additional 128 values from decimal 128 through decimal 255 (hex 80 through hex FF). The latter values include the accented Latin letters used in common Western European languages, plus some symbolic values such as the paragraph mark (¶) and the trademark symbol (™).</p>
  </div>
  <div class="paragraph">
  <p>Other ISO character sets in the 8859 series accommodate non-Latin character sets. For example, MSH-18 Character Set could be valued <strong>8859/2</strong> to specify the default character encoding in use in Eastern Europe, while <strong>8859/6</strong> indicates the use of the Arabic alphabet.</p>
  </div>
  <div class="paragraph">
  <p>The ASCII and ISO character sets all allow the specification of any character in a single byte.</p>
  </div>
  </div>
  <div class="sect4">
  <h5 id="_non_alphabetic_languages">Non-Alphabetic Languages</h5>
  <div class="paragraph">
  <p>HL7 Table 0211 includes values for languages that do not use alphabets. These include ideographic written languages, such as the Japanese Graphic Character Set which is specified as <strong>ISO IR87</strong>.</p>
  </div>
  <div class="paragraph">
  <p>There are non-alphabetic encoding systems for which HL7 Table 0211 does not provide specific entries. One of these is the Traditional Chinese character set, CNS 11643, which is used in Taiwan. This character set can, however, be encoded using the Unicode Standard, which does have a value in HL7 0211.</p>
  </div>
  <div class="paragraph">
  <p>The Unicode Standard (which is now coordinated with ISO 10646) permits the specification of multiple-byte characters in a much larger range than is available in a single-byte ASCII or ISO character set. Unicode Version 3.1 (<a href="http://www.unicode.org" class="bare">http://www.unicode.org</a>) includes almost 100,000 characters, including many Chinese, Japanese, and Korean ideographs. This is particularly valuable to implementers who need to encode messages in more than one character set, as for example to accommodate the use of both alphabetic and ideographic characters.</p>
  </div>
  <div class="paragraph">
  <p>Non-alphabetic encoding systems do not restrict characters to a length of one byte. Unicode incorporates three encoding forms that allow for the use of multiple bytes to encode a message. The most flexible Unicode encoding form is UTF-8, which uses high-order bits to specify the number of bytes (from one to six) used to encode each character.</p>
  </div>
  <div class="paragraph">
  <p>Interestingly, Unicode UTF-8 incorporates the 7-bit ASCII character set as single-byte codes. This means that a message encoded in 7-bit ASCII can be submitted to a destination using Unicode UTF- 8 with no modification.</p>
  </div>
  </div>
  </div>
  <div class="sect3">
  <h4 id="_nte_field_definitions">NTE field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_ovr_field_definitions">OVR field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_sft_field_definitions">SFT field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_sgh_field_definitions">SGH field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_sgt_field_definitions">SGT field definitions</h4>
  
  </div>
  <div class="sect3">
  <h4 id="_uac_field_definitions">UAC Field Definitions</h4>
  
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_data_types_2">Data types</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70440"><em>HL7 Table 0440 – Data Types</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_miscellaneous_hl7_tables_used_across_all_chapters">Miscellaneous HL7 tables used across all chapters</h2>
  <div class="sectionbody">
  <div class="sect2">
  <h3 id="_message_type_table_0076">Message Type Table (0076)</h3>
  <div class="paragraph">
  <p>Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70076"><em>HL7 Table 0076 – Message Type</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_event_type_table_0003">Event Type Table (0003)</h3>
  <div class="paragraph">
  <p>Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70003"><em>HL7 Table 0003 – Event Type</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_structure_table_0354">Message Structure Table (0354)</h3>
  <div class="paragraph">
  <p>The first column of this table contains the message structure code, which describes a particular HL7 "abstract message structure definition" in terms of segments, as defined in section <em>2.10.8</em>, "<em>Message representation</em></p>
  </div>
  <div class="paragraph">
  <p>For each trigger event the messages that are exchanged when the trigger event occurs are defined using the HL7 abstract message syntax as follows:</p>
  </div>
  <div class="paragraph">
  <p>Each message is defined in special notation that lists the segment IDs in the order they would appear in the message. Braces, \{ . . . }, indicate one or more repetitions of the enclosed group of segments. Of course, the group MAY contain only a single segment. Brackets, [ . . . ], show that the enclosed group of segments is optional. If a group of segments is optional and MAY repeat it SHALL be enclosed in brackets and braces, [\{&#8230;&#8203;}].</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  [\{&#8230;&#8203;}] and \{[&#8230;&#8203;]} are equivalent.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>Whenever braces or brackets enclose more than one segment ID a special stylistic convention is used to help the reader understand the hierarchy of repetition. For example, the first segment ID appears on the same line as the brace, two columns to the right. The subsequent segment IDs appear under the first. The closing brace appears on a line of its own in the same column as the opening brace. This convention is an optional convenience to the user. If there is conflict between its use and the braces that appear in a message schematic, the braces define the actual grouping of segments that is permitted.</p>
  </div>
  <div class="paragraph">
  <p>A choice of one segment from a group of segments is indicated by using angle brackets to delimit the group and vertical bar delimiters between the several segments.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  The following example allows a choice of segments :
  </div>
  </div>
  <div class="paragraph">
  <p>&lt;ABC | DEF | GHI | JKL &gt;</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  The following example allows a choice of segments and/or segment groups. (see Figure 2-5 Hypothetical schematic message)
  </div>
  </div>
  <div class="paragraph">
  <p>The first choice is a repeating group consisting of an ABC segment followed by optionally repeating NTE segments.</p>
  </div>
  <div class="paragraph">
  <p>The second choice is the DEF segment.</p>
  </div>
  <div class="paragraph">
  <p>The third choice is a group with a required GHI segment followed by an optionally repeating group containing a PRT segment followed by an optionally repeating NTE segment.</p>
  </div>
  <div class="paragraph">
  <p>&lt;\{ABC [{NTE}] } |DEF | GHI [\{PRT [{NTE}] }] &gt;</p>
  </div>
  <div class="paragraph">
  <p>Chapter Formats For Defining HL7 Messages". The second column lists the various HL7 trigger events that use the particular abstract message definition. For example, the message structure code ADT_A01 describes the single abstract message structure used by the trigger events A01, A04, A08 and A13. Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70354"><em>HL7 Table 0354 – Message Structure</em></a> in Chapter 2C, Code Tables, for valid values</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_coding_system_table_0396">Coding System Table (0396)</h3>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  The Vocabulary T.C. is the steward of HL7 Table 0396. As of v2.6, no special characters, except for underscore if absolutely necessary, are allowed for the Value in this table.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70396"><em>HL7 Table 0396 - Coding System</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_yesno_indicator_table_0136">Yes/no Indicator Table (0136)</h3>
  <div class="paragraph">
  <p>The actual interpretation of Yes/No is context sensitive. Individual chapters will further refine the meaning of Yes/No in their specific context. Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70136"><em>HL7 Table 0136 - Yes/no Indicator</em></a> in Chapter 2C, Code Tables, for valid values</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_expanded_yesno_indicator_table_0532">Expanded Yes/no Indicator Table (0532)</h3>
  <div class="paragraph">
  <p>This table expands on the original Yes/no indicator table by including "flavors of null". It is intended to be applied to fields where the response is not limited to "yes" or "no". Refer to <a href="file:///E:\V2\v2.9%20final%20Nov%20from%20Frank\V29_CH02C_Tables.docx#HL70532"><em>HL7 Table 0532 – Expanded Yes/no Indicator</em></a> in Chapter 2C, Code Tables, for valid values.</p>
  </div>
  <div class="paragraph">
  <p>Use Case: A reporting facility/person has little or no information on a particular event or outcome and these are reported as unknown for public health reporting purposes.</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_sample_control_messages">Sample Control Messages</h2>
  <div class="sectionbody">
  <div class="sect2">
  <h3 id="_general_acknowledgment">General acknowledgment</h3>
  <div class="paragraph">
  <p>LAB acknowledges the message that ADT sent identified as ZZ9380. (LAB and ADT, the sending and receiving system IDs, are site-defined.) Both systems are associated with the same FACILITY, 767543. The <strong>AA</strong> code in the MSA segment indicates that the message was accepted by the application.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|LAB|767543|ADT|767543|19900314130405-500||ACK</sup>A08^ACK |XX3657|P|2.9&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>MSA|AA|ZZ9380&lt;cr&gt;</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_general_acknowledgment_error_return">General acknowledgment, error return</h3>
  <div class="paragraph">
  <p>The <strong>AR</strong> code in MSA indicates that the application rejected the message for functional reasons. The optional ERR segment includes here that the 16th field of the PID segment with the SET ID value of 1 had an error which was defined by the locally-established code X3L. The optional text message UNKNOWN COUNTY CODE in the link is designed to help programmers and support personnel while reviewing message logs.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|LAB|767543|ADT|767543|199003141304-0500||ACK</sup>A08^ACK |XX3657|P|2.9&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>MSA|AR|ZZ9380| &lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>ERR| |PID<sup>1</sup>11^^9|103|E&lt;cr&gt;</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_using_sequence_number_protocol">Message using sequence number: protocol</h3>
  <div class="paragraph">
  <p>The sender initiates the link with a message that has no functional content. The sequence number is 0. The message type and event code are not used.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|ADT|767543|LAB|767543|199003141304-0500||ADT</sup>A08^ADT_A01|XX3657|P|2.9|0&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>The responder uses a general acknowledgment. The expected sequence number is 1.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|LAB|767543|ADT|767543|199003141304-0500||ACK</sup>A08^ACK |ZZ9380|P|2.9&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>MSA|AA|XX3657||1&lt;cr&gt;</p>
  </div>
  <div class="paragraph">
  <p>See section 2.9.1, "Sequence number protocol" for further detail.</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_message_fragmentation">Message fragmentation</h3>
  <div class="paragraph">
  <p>This summarizes the methodology for splitting a single logical HL7 message among two or more actual HL7 messages. The actual specifications for this, the segment definitions of the ADD and DSC segments, and examples are in Section <em>2.9.2</em>, "<em>Continuation messages and segments</em>".</p>
  </div>
  <div class="paragraph">
  <p>Continuing of messages is a generic methodology that can be used for all HL7 message types. It can be used to split based on segment boundaries, on field boundaries, and to split a single field among several messages. It utilizes two specific segments, ADD and DSC, as well as a field in the message header, MSH-14 Continuation Pointer.</p>
  </div>
  <div class="paragraph">
  <p>When a message is continued, a unique continuation value is used. This same value will appear in MSH-14 and DSC-1 as appropriate for a single pair of messages. This allows messages to be "chained together".</p>
  </div>
  <div class="paragraph">
  <p>Here are two examples of ways to create continuation pointers for fragmented messages. The only absolute requirement is that when the sending application values the continuation pointer, the receiving application can appropriately reconstruct the message.</p>
  </div>
  <div class="paragraph">
  <p>Sitecode-interfaceapplicationcode-date-sequentialcounterwithindate</p>
  </div>
  <div class="paragraph">
  <p>This will guarantee uniqueness of this field.</p>
  </div>
  <div class="paragraph">
  <p>e.g., BWH-LDS-19990331-27 for the 27<sup>th</sup> large message to be created on March 31, within the Discharge Summary interfaces at BWH</p>
  </div>
  <div class="paragraph">
  <p>An alternative method of valuing the continuation pointer:</p>
  </div>
  <div class="paragraph">
  <p>Sitecode-interfaceapplicationcode-medicalrecordnumber-datetime</p>
  </div>
  <div class="paragraph">
  <p>e.g. MGH-PCIS-1234567-19980331121314 for a message created on March 31, at 12:13:14pm for patient medical record number 1234567, within the PCIS interfaces at MGH</p>
  </div>
  <div class="paragraph">
  <p>Sending Application Note: In the ADD segment, a trailing field delimiter, i.e., the vertical bar character, after the final field, has explicit meaning. The sending application SHOULD NOT include a trailing field delimiter for the last field in the ADD segment unless it has completely valued the entire field from the message being continued.</p>
  </div>
  <div class="paragraph">
  <p>Receiving Application Note: The receiving application will need to be concerned with a single segment and a single field being continued.</p>
  </div>
  <div class="paragraph">
  <p>Receiving a message with an empty ADD segment followed by a DSC segment is the notification that the segment preceding the ADD is being continued in a subsequent message. Note that the continuing message might not be the next one received! The receiver must match up the continuation pointer value from MSH-14 of subsequent messages to the DSC-1 continuation pointer value of the prior message. Also if the continuing message contains an ADD segment, the receiver SHOULD continue appending to the fields from the segment being continued with values from the ADD segment. For example, if OBX-5 is being continued, the continuation will appear in ADD-1 of the continuing message. If there were a value for OBX-13 of the original message, that would appear in ADD-9 of the continuing message, assuming that the remainder of the OBX segment fit into the single ADD segment.</p>
  </div>
  <div class="paragraph">
  <p>Question: if continuing a message after the completion of a complete segment, SHOULD the continuing message have an empty ADD segment or not? Answer: No. This means that a continuing message need not have an ADD segment, if the continued message was split on a segment boundary.</p>
  </div>
  <div class="paragraph">
  <p>Notation conventions: items within angle brackets are comments and not intended to represent a portion of an actual message. For example, &lt;this is a comment&gt;.</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  the multiple continuation pointer values, one for each pair of physical messages.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p><strong>Message 1</strong></p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;||&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>ORC|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBR|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBX|1|FT|^Discharge Summary|1|This is the first sentence of a long</p>
  </div>
  <div class="paragraph">
  <p>message. This is the second sentence of a long message.</p>
  </div>
  <div class="paragraph">
  <p>&lt;snip&gt;</p>
  </div>
  <div class="paragraph">
  <p>This is the 967th sentence of "</p>
  </div>
  <div class="paragraph">
  <p>ADD|</p>
  </div>
  <div class="paragraph">
  <p>DSC|BWH-LDS-19990405-6|</p>
  </div>
  <div class="paragraph">
  <p><strong>Message 2</strong></p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;|BWH-LDS-19990405-6|</p>
  </div>
  <div class="paragraph">
  <p>ADD|a long message. This is the 968th sentence of a long message.</p>
  </div>
  <div class="paragraph">
  <p>&lt;snip&gt;</p>
  </div>
  <div class="paragraph">
  <p>This is the 1001st line of</p>
  </div>
  <div class="paragraph">
  <p>&lt;there SHOULD be no trailing field delimiter after the last field in this ADD segment&gt;</p>
  </div>
  <div class="paragraph">
  <p>DSC|BWH-LDS-19990405-7|</p>
  </div>
  <div class="paragraph">
  <p><strong>Message 3</strong></p>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;|BWH-LDS-19990405-7|</p>
  </div>
  <div class="paragraph">
  <p>ADD|a long message. This is the 1002nd sentence of a long message. &lt;snip&gt; This is the final sentence of this long message!|||||F||199707211325|</p>
  </div>
  <div class="paragraph">
  <p>DG1|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>&lt;end of message&gt;</p>
  </div>
  <div class="paragraph">
  <p>The following examples discuss an unsolicited transmission of an observation message, ORU^R01.</p>
  </div>
  <div class="paragraph">
  <p>The expected result values in OBX-5 Observation Value, for reports (e.g., autopsy, pathology) MAY exceed the message length restrictions of one or more interfaces.</p>
  </div>
  <div class="paragraph">
  <p>Thus the OBX-5 Observation Value data element will be split into more than one message.</p>
  </div>
  <div class="paragraph">
  <p>Here&#8217;s an example intended to illustrate the interpretation of Chapter 2 and 7. It reflects a single logical message broken up into three distinct messages.</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  1, a single field being split across three messages
  </div>
  </div>
  <div class="paragraph">
  <p>Message #1: ---------------------------------------------------------------</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-14, continuation pointer, is empty.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;||&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>ORC|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBR|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBX|1|FT|^Discharge Summary|1|This is the first sentence of a long</p>
  </div>
  <div class="paragraph">
  <p>message. This is the second sentence of a long message.</p>
  </div>
  <div class="paragraph">
  <p>&lt;snip&gt;</p>
  </div>
  <div class="paragraph">
  <p>This is the 967<sup>th</sup> sentence of "</p>
  </div>
  <div class="paragraph">
  <p>ADD|</p>
  </div>
  <div class="paragraph">
  <p>DSC|&lt;continuation-pointer-value-1&gt;|F</p>
  </div>
  <div class="paragraph">
  <p>Message #2: --------------------------------------------------------------</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-14, continuation pointer, is valued with the same value as in DSC-1, continuation pointer from the message this is continuing, in this case Message #1.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;|&lt;continuation-pointer-value-1&gt;|</p>
  </div>
  <div class="paragraph">
  <p>ADD|a long message. This is the 968th sentence of a long message.</p>
  </div>
  <div class="paragraph">
  <p>&lt;snip&gt;</p>
  </div>
  <div class="paragraph">
  <p>This is the 1001st line of</p>
  </div>
  <div class="paragraph">
  <p>&lt;there SHOULD be no trailing field delimiter after the last field in this ADD segment&gt;</p>
  </div>
  <div class="paragraph">
  <p>DSC|&lt;continuation-pointer-value-2&gt;|F</p>
  </div>
  <div class="paragraph">
  <p>Message #3: ---------------------------------------------------------------</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-14, continuation pointer, is valued with the same value as in DSC-1, continuation pointer from the message this is continuing, in this case Message #1.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;|&lt;continuation-pointer-value-2&gt;|</p>
  </div>
  <div class="paragraph">
  <p>ADD|a long message. This is the 1002nd sentence of a long message. &lt;snip&gt; This is the final sentence of this long message!|||||F||199707211325|</p>
  </div>
  <div class="paragraph">
  <p>&lt;remaining segments after the big OBX from the original message go here, after the ADD segment&gt;</p>
  </div>
  <div class="paragraph">
  <p>PR1|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>DG1|&#8230;&#8203;</p>
  </div>
  <div class="exampleblock">
  <div class="content">
  2, a single message being split across two messages, but on segment boundaries
  </div>
  </div>
  <div class="paragraph">
  <p>Message #1: ---------------------------------------------------------------</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-14, continuation pointer, is empty.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;||&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>PID|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>ORC|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBR|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>OBX|1|FT|^Discharge Summary|1|This is the first sentence of a long</p>
  </div>
  <div class="paragraph">
  <p>message. This is the final sentence of this long discharge summary!|||||F||199707211325|</p>
  </div>
  <div class="paragraph">
  <p>DSC|&lt;continuation-pointer-value-3&gt;|F</p>
  </div>
  <div class="paragraph">
  <p>Message #2: --------------------------------------------------------------</p>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  MSH-14 Continuation Pointer, is valued with the same value as in DSC-1, continuation pointer from the message this is continuing, in this case Message #1.
  </td>
  </tr>
  </table>
  </div>
  <div class="admonitionblock note">
  <table>
  <tr>
  <td class="icon">
  <div class="title">Note</div>
  </td>
  <td class="content">
  that no ADD segment is necessary, since a segment is not being split across two messages.
  </td>
  </tr>
  </table>
  </div>
  <div class="paragraph">
  <p>MSH|&#8230;&#8203;|&lt;field-13&gt;|&lt;continuation-pointer-value-3&gt;|</p>
  </div>
  <div class="paragraph">
  <p>PR1|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>DG1|&#8230;&#8203;</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_acknowledgment_message_using_original_mode_processing">Acknowledgment message using original mode processing</h3>
  <div class="paragraph">
  <p>This example shows the lab system using the Master Files specification to send two update test dictionary entries to an ICU system.</p>
  </div>
  <div class="paragraph">
  <p>Initiating Message:</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|LABxxx|ClinLAB|ICU||19910918060544-500||MFN</sup>M03^MFN_M03|MSGID002|P|2.9</p>
  </div>
  <div class="paragraph">
  <p>MFI|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>Response Message: Original mode acknowledgment of the HL7 message according to MFI Response Level Code of AL.</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|ICU||LABxxx|ClinLAB|19910918060545-500||MFK</sup>M03^MFK_M01|MSGID99002|P|2.9</p>
  </div>
  <div class="paragraph">
  <p>MSA|AA|MSGID002</p>
  </div>
  <div class="paragraph">
  <p>MFI|LABxxx^Lab Test Dictionary^L|UPD|||MFAA</p>
  </div>
  <div class="paragraph">
  <p>MFA|MUP|199110010000|199110010040|S|12345<sup>WBC</sup>L</p>
  </div>
  <div class="paragraph">
  <p>MFA|MUP|199110010000|199110010041|S|6789<sup>RBC</sup>L&#8230;&#8203;</p>
  </div>
  </div>
  <div class="sect2">
  <h3 id="_acknowledgment_message_using_enhanced_mode_processing">Acknowledgment message using enhanced mode processing</h3>
  <div class="paragraph">
  <p>Initial message with accept acknowledgment</p>
  </div>
  <div class="paragraph">
  <p>MSH|<sup>~\&amp;|LABxxx|ClinLAB|ICU||19910918060544-500||MFN</sup>M03^MFN_M03|MSGID002|P|2.9|||AL|AL</p>
  </div>
  <div class="paragraph">
  <p>MFI|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>MSH|^~\&amp;|ICU||LABxxx|ClinLAB|19910918060545-500||MSA|MSGID99002|P|2.9</p>
  </div>
  <div class="paragraph">
  <p>MSA|CA|MSGID002</p>
  </div>
  <div class="paragraph">
  <p>Application acknowledgment message</p>
  </div>
  <div class="paragraph">
  <p>MSH|^~\&amp;|ICU||LABxxx|ClinLAB|19911001080504-500|| MFK<sup>M03</sup>MFK_M01|MSGID5002|P|2.9|||AL|</p>
  </div>
  <div class="paragraph">
  <p>MSA|AA|MSGID002</p>
  </div>
  <div class="paragraph">
  <p>MFI|&#8230;&#8203;</p>
  </div>
  <div class="paragraph">
  <p>MSH|^~\&amp;|LABxxx|ClinLAB|ICU||19911001080507-500||ACK|MSGID444|P|2.9</p>
  </div>
  <div class="paragraph">
  <p>MSA|CA|MSGID5002</p>
  </div>
  </div>
  </div>
  </div>
  <div class="sect1">
  <h2 id="_outstanding_issues">Outstanding Issues</h2>
  <div class="sectionbody">
  <div class="paragraph">
  <p>The following items are being discussed in the Infrastructure and Messaging work group for addition to future versions of HL7:</p>
  </div>
  </div>
  </div>
</div>
